[{"path":"https://liaoyjruby.github.io/Rubrary/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 Rubrary authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Differential Gene Expression","text":"","code":"library(Rubrary) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(tibble)  # For `airway` install r = getOption(\"repos\") r[\"CRAN\"] = \"http://cran.us.r-project.org\" options(repos = r)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Differential Gene Expression","text":"example dataset vignette comes paper [1] : Himes et al. (2014). “RNA-Seq Transcriptome Profiling Identifies CRISPLD2 Glucocorticoid Responsive Gene Modulates Cytokine Function Airway Smooth Muscle Cells.” PLoS ONE, 9(6), e99625. https://doi.org/10.1371/journal.pone.0099625. abstract: Using RNA-Seq, high-throughput sequencing method, characterized transcriptomic changes four primary human ASM cell lines treated dexamethasone—potent synthetic glucocorticoid (1 µM 18 hours). experiment performed human airway smooth muscle (ASM) cells. Glucocorticoids commonly used drug treat asthma anti-inflammatory effects lung tissue. goal experiment characterize mechanism glucocorticoid inflammation suppression RNAseq. Himes et al. found number glucocorticoid-responsive genes DUSP1 CRISPLD2. also identified enrichment functional annotation terms “glycoprotein/extracellular matrix”, “vasculature development”, “circulatory system process”. original paper, authors used Cuffdiff 2 find differential gene expression used NIH Database Annotation, Visualization, Integrated Discovery (DAVID) gene set enrichment analysis.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"load-data","dir":"Articles","previous_headings":"","what":"Load data","title":"Differential Gene Expression","text":"package airway contains data Himes et al. paper form RangedSummarizedExperiment object hosted Bioconductor.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"get-airway-data-from-package","dir":"Articles","previous_headings":"Load data","what":"Get airway data from package","title":"Differential Gene Expression","text":"","code":"if (!requireNamespace(\"airway\", quietly = TRUE)){   BiocManager::install(\"airway\") }  library(airway) data(airway)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"get-counts-and-sample-annotation","dir":"Articles","previous_headings":"Load data","what":"Get counts and sample annotation","title":"Differential Gene Expression","text":"gene expression data represented counts. 4 samples treated dexamethasone (anno$dex == \"trt\") 4 untreated samples (anno$dex == \"untrt\").","code":"# Counts cts <- assay(airway, \"counts\") # Annotation anno <- colData(airway) %>% as.data.frame() anno$dex <- relevel(anno$dex, \"untrt\") # Set untreated as first factor  rmarkdown::paged_table(data.frame(cts)) rmarkdown::paged_table(anno)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"replace-ensembl-id-w-hgnc-symbol","dir":"Articles","previous_headings":"Load data > Get counts and sample annotation","what":"Replace Ensembl ID w/ HGNC symbol","title":"Differential Gene Expression","text":"airway gene names given Ensembl ID, HGNC gene symbols can easier interpret downstream analysis compatible gene set enrichment analysis (GSEA) tools.","code":"# Gene format is currently in Ensembl ID format head(rownames(cts)) #> [1] \"ENSG00000000003\" \"ENSG00000000005\" \"ENSG00000000419\" \"ENSG00000000457\" #> [5] \"ENSG00000000460\" \"ENSG00000000938\"  library(biomaRt) # Load Mart object - database of Homo sapiens genes from Ensembl mart <- biomaRt::useDataset(   dataset = \"hsapiens_gene_ensembl\",   mart = biomaRt::useMart(\"ENSEMBL_MART_ENSEMBL\",                           host=\"https://useast.ensembl.org\"))  conv <- Rubrary::convert_genes(     genes = rownames(cts),     from_to = c(\"ensembl_gene_id\", \"hgnc_symbol\"),     mart = mart, table = T) %>%   filter(hgnc_symbol != \"\") %>% # Exclude unmatched HGNC symbols   distinct(hgnc_symbol, .keep_all = T)  cts <- cts %>%   as.data.frame() %>%   tibble::rownames_to_column(\"ensembl_gene_id\")  cts_hgnc <- dplyr::left_join( # Join stats with HGNC symbol table   conv, cts, by = \"ensembl_gene_id\") %>%   dplyr::select(!ensembl_gene_id) %>%   tibble::column_to_rownames(\"hgnc_symbol\")  # Genes now have associated HGNC symbols rmarkdown::paged_table(head(cts_hgnc))"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"visualize-samples-w-pca","dir":"Articles","previous_headings":"Load data","what":"Visualize samples w/ PCA","title":"Differential Gene Expression","text":"Since already created Mart object converting gene symbols, can reuse avoid querying BioMart database load protein coding genes efficiently.","code":"# Upper quartile normalize cts_UQ <- Rubrary::quantile_norm(cts_hgnc, q = 75) # Log transform pc_genes <- Rubrary::get_PC_genes(mart) cts_log2UQ <- Rubrary::get_log_coding_geneexp(cts_UQ, pc_genes = pc_genes) #> Warning: 396 genes not found in dataframe gene list:  #> KIR2DS2, KIR3DS1, PPIAL4F, KIR2DS5, KIR2DL2, KIR2DL5A, KIR2DS3, KIR2DL5B, KIR2DS1, CYFIP1, ... #> ** Search may take a long time to run! # Rubrary::run_PCA airway_PCA <- Rubrary::run_PCA(cts_log2UQ) #> ** Cumulative var. exp. >= 80% at PC 4 (81.4%) # Rubrary::plot_PCA Rubrary::plot_PCA(   df_pca = airway_PCA,   anno = tibble::rownames_to_column(anno, \"Sample_ID\"),   annoname = \"Sample_ID\",   annotype = \"dex\",   label = TRUE ) # Rubrary::plot_PCA_matrix Rubrary::plot_PCA_matrix(   df_pca = airway_PCA,   anno = tibble::rownames_to_column(anno, \"Sample_ID\"),   annoname = \"Sample_ID\",   annotype = \"cell\" ) #> Registered S3 method overwritten by 'GGally': #>   method from    #>   +.gg   ggplot2"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"deseq2-differentially-expressed-genes","dir":"Articles","previous_headings":"","what":"DESeq2 differentially expressed genes","title":"Differential Gene Expression","text":"DESeq2 [2] performs differential gene expression analysis modeling counts negative binomial distribution.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"create-deseqdataset-object-and-run-deseq","dir":"Articles","previous_headings":"DESeq2 differentially expressed genes","what":"Create DESeqDataSet object and run DESeq","title":"Differential Gene Expression","text":"DESeq2::results documentation, contrast argument can formatted : character vector exactly three elements: name factor design formula, name numerator level fold change, name denominator level fold change (simplest case) Thus, fold change per gene results represents change dex condition, \\(FC = \\frac{\\text{trt}}{\\text{untrt}}\\). \\(FC > 1\\) results \\(\\log(FC) > 0\\), increase gene expression treated samples relative untreated samples. Rubrary::output_DESeq takes DESeqResults object, transforms dataframe, adds sign log2 p-value column.","code":"library(DESeq2)  dds <- DESeqDataSetFromMatrix(   countData = cts_hgnc[,rownames(anno)],   colData = anno,   design = ~ dex)  dds <- DESeq(dds) #> estimating size factors #> estimating dispersions #> gene-wise dispersion estimates #> mean-dispersion relationship #> final dispersion estimates #> fitting model and testing res <- results(dds, contrast = c(\"dex\", \"trt\", \"untrt\")) deseq_res_df <- Rubrary::output_DESeq(res)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"filter-to-protein-coding-genes","dir":"Articles","previous_headings":"DESeq2 differentially expressed genes","what":"Filter to protein coding genes","title":"Differential Gene Expression","text":"ease interpretation, DE genes results can also filtered protein coding genes . Rubrary::filter_genes() can filter list protein coding genes retrieved Rubrary::get_PC_genes().","code":"deseq_res_df_PC <- Rubrary::filter_genes(   df = deseq_res_df,   gene_col = \"gene\",   genes_filt = pc_genes ) %>%   `rownames<-`(NULL) %>%   as.data.frame() %>%   tibble::column_to_rownames(\"gene\") #> Warning: 3015 genes not found in dataframe gene list:  #> SNTG2, KIR3DL2, KIR3DL3, KIR3DL1, PTCHD3, KIR3DP1, KIR2DL4, KIR2DS2, FCAR, NPBWR2, ... #> ** Search may take a long time to run!"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"gene-expression-boxplot","dir":"Articles","previous_headings":"DESeq2 differentially expressed genes","what":"Gene expression boxplot","title":"Differential Gene Expression","text":"","code":"Rubrary::plot_DEgene_boxplot(   data = cts_log2UQ,   anno = anno,   anno_sig = \"dex\",   anno_type = \"cell\",   sig_DE = deseq_res_df_PC )"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/DE_Genes.html","id":"volcano-plot","dir":"Articles","previous_headings":"DESeq2 differentially expressed genes","what":"Volcano plot","title":"Differential Gene Expression","text":"DESeq results can visualized volcano plots. Volcano plots show top bottom differentially expressed genes sorted decreasing signed log p value present outliers top right top left.","code":"rmarkdown::paged_table(   head(deseq_res_df_PC[order(deseq_res_df_PC$sign_log_p, decreasing = T),])) rmarkdown::paged_table(   tail(deseq_res_df_PC[order(deseq_res_df_PC$sign_log_p, decreasing = T),])) Rubrary::plot_volcano(   df = tibble::rownames_to_column(deseq_res_df_PC, \"gene\"),   names = \"gene\",   x = \"log2FoldChange\", y = \"pvalue\",   FCcutoff = 1, pCutoff = 5e-04,   title = \"Airway Treated vs. Untreated DE Genes\",   xlab_high = \"\\U2191 in treated\\n\\U2193 in untreated\",   xlab_low = \"\\U2191 in untreated\\n\\U2193 in treated\",   subtitle = \"Protein coding genes\" )"},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/articles/GSEA.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Gene Set Enrichment Analysis (GSEA)","text":"continuation “Differential Gene Expression” vignette loads airway DESeq2 results investigate gene sets.","code":"library(Rubrary) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(tibble) data(\"airway_deseq_res\") rmarkdown::paged_table(airway_deseq_res)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/GSEA.html","id":"fgsea-gene-set-enrichment-analysis","dir":"Articles","previous_headings":"","what":"fgsea Gene Set Enrichment Analysis","title":"Gene Set Enrichment Analysis (GSEA)","text":"fgsea [1] implementation algorithm fast gene set enrichment analysis (GSEA), based original GSEA algorithm [2].","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/GSEA.html","id":"get-pathways-from-msigdbr","dir":"Articles","previous_headings":"fgsea Gene Set Enrichment Analysis","what":"Get pathways from msigdbr","title":"Gene Set Enrichment Analysis (GSEA)","text":"Gene set enrichment analysis relies inputting gene sets / pathways related biological function. Molecular Signatures Database (MSigDB) [3] database annotated pathways facilitate GSEA accessible R package msigdbr [4]. Human MSigDB Collections C2CP: curated gene sets, canonical pathways C5GO: ontology gene sets, Gene Ontology gene sets BP: GO Biological Process ontology CC: GO Cellular Component ontology MF: GO Molecular Function ontology H: hallmark gene sets [5] list gene sets MSigDB provided Rubrary data object GSEA_pathways.","code":"if (!requireNamespace(\"msigdbr\", quietly = TRUE)){   BiocManager::install(\"msigdbr\") }  rmarkdown::paged_table(msigdbr::msigdbr_collections()) pthwys <- rbind(   msigdbr::msigdbr(category = \"C2\", subcategory = \"CP\"),   msigdbr::msigdbr(category = \"C5\", subcategory = \"GO:BP\"),   msigdbr::msigdbr(category = \"C5\", subcategory = \"GO:CC\"),   msigdbr::msigdbr(category = \"C5\", subcategory = \"GO:MF\"),   msigdbr::msigdbr(category = \"H\") ) %>%   split(x = .$gene_symbol, f = .$gs_name) # Named list of pathways"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/GSEA.html","id":"run-fgsea","dir":"Articles","previous_headings":"fgsea Gene Set Enrichment Analysis","what":"Run fgsea","title":"Gene Set Enrichment Analysis (GSEA)","text":"See GSEA User Guide: Interpreting GSEA Results detailed explanation interpreting results.","code":"# `fgsea` requires a named numeric vector as input to the `stats` argument deseq_stats <- setNames(     airway_deseq_res[,\"sign_log_p\"],      airway_deseq_res[,\"hgnc_symbol\"] )  gsea_results <- fgsea::fgsea(   pathways = pthwys,   stats = deseq_stats,   eps = 0.0,   minSize = 15,   maxSize  = 500) %>%   arrange(desc(NES)) %>%   mutate(sign_log10_p = sign(NES) * -log10(pval)) # Create sign_log10_p column #> Warning in preparePathwaysAndStats(pathways, stats, minSize, maxSize, gseaParam, : There are ties in the preranked stats (6.92% of the list). #> The order of those tied genes will be arbitrary, which may produce unexpected results.  rmarkdown::paged_table(gsea_results)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/GSEA.html","id":"visualize-gsea-results-as-a-table","dir":"Articles","previous_headings":"fgsea Gene Set Enrichment Analysis","what":"Visualize GSEA results as a table","title":"Gene Set Enrichment Analysis (GSEA)","text":"Using fgsea’s plotGseaTable function.  Using Rubrary::plot_GSEA_barplot function - simpler visualization GSEA NES values bit nicer looking?","code":"# Get top significant pathways by positive/negative enrichment score (ES) pos_pws <- gsea_results[ES > 0][head(order(pval), n = 5), pathway] neg_pws <- gsea_results[ES < 0][head(order(pval), n = 5), pathway] top_pws <- c(pos_pws, rev(neg_pws))  fgsea::plotGseaTable(   pathways = pthwys[top_pws],   stats = deseq_stats,   fgseaRes = gsea_results,   gseaParam = 0.5 ) Rubrary::plot_GSEA_barplot(   gsea_res = gsea_results,   gsea_pws = top_pws,   NES_cutoff = 1.5,   sig_cutoff = c(\"pval\", 0.05),   pw_format = TRUE,   title = \"Airway GSEA\" )"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/GSEA.html","id":"pathway-enrichment-plot","dir":"Articles","previous_headings":"fgsea Gene Set Enrichment Analysis","what":"Pathway enrichment plot","title":"Gene Set Enrichment Analysis (GSEA)","text":"Specific pathways interest can plotted GSEA Java app-like enrichment plots combine waterfall mountain plot. top enriched pathway GSEA results “HALLMARK_ADIPOGENESIS”, collection 196 genes -regulated adipocyte (fat cell) differentiation. line studies reporting complex effects glucocorticoids adipose tissue biology, including differentiation adipocyte precursors adipogenesis [6,7]. maximum absolute value Enrichment Score mountain plot corresponds ES value reported GSEA results.  smaller gene sets, like 20-gene pathway “GOBP_NEURON_FATE_SPECIFICATION”, labeling gene may appropriate.  Multiple gene set enrichment plots can created batch Rubrary::plot_GSEA_batch, wrapper Rubrary::plot_GSEA_pathway works well lapply. can use neg_pws list pathway names plot gene enrichment plots significant negatively enriched pathways.","code":"rmarkdown::paged_table(   gsea_results[gsea_results$pathway == \"HALLMARK_ADIPOGENESIS\",]) Rubrary::plot_GSEA_pathway(   sig = airway_deseq_res,   geneset = pthwys[[\"HALLMARK_ADIPOGENESIS\"]],   genecol = \"hgnc_symbol\",   rankcol = \"sign_log_p\",   rankcol_name = \"DESeq sign log2 p-value\",   label = FALSE,   title = \"Airway DE Genes: HALLMARK_ADIPOGENESIS\",   lab_high = \"\\U2191 in treated\\n\\U2193 in untreated\",   lab_low = \"\\U2191 in untreated\\n\\U2193 in treated\" ) rmarkdown::paged_table(   gsea_results[gsea_results$pathway == \"GOBP_NEURON_FATE_SPECIFICATION\",]) Rubrary::plot_GSEA_pathway(   sig = airway_deseq_res,   geneset = pthwys[[\"GOBP_NEURON_FATE_SPECIFICATION\"]],   genecol = \"hgnc_symbol\",   rankcol = \"sign_log_p\",   rankcol_name = \"DESeq sign log2 p-value\",   label = TRUE,   title = \"Airway DE Genes: GOBP_NEURON_FATE_SPECIFICATION\",   lab_high = \"\\U2191 in treated\\n\\U2193 in untreated\",   lab_low = \"\\U2191 in untreated\\n\\U2193 in treated\" ) rmarkdown::paged_table(   gsea_results[gsea_results$pathway %in% neg_pws[1:3],]) lapply(   neg_pws[1:3],   FUN = Rubrary::plot_GSEA_pathway_batch,   genecol = \"hgnc_symbol\",   pthwys = pthwys,   sig = airway_deseq_res,   rankcol = \"sign_log_p\",   rankcol_name = \"DESeq sign log2 p-value\",   hllab = \"Pathway genes\",   lab_high = \"\\U2191 in treated\\n\\U2193 in untreated\",   lab_low = \"\\U2191 in untreated\\n\\U2193 in treated\" ) #> [[1]] #>  #> [[2]] #>  #> [[3]]"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"beltran-et-al--2016-pca","dir":"Articles","previous_headings":"","what":"Beltran et al. 2016 PCA","title":"Principal Component Analysis (PCA) Quickstart","text":"replicates PCA portions graeberlab-ucla/glab.library PCA tutorial using Beltran et al. 2016(Beltran et al. 2016) CRPC/NEPC data initiate many new computational Graeber Lab members lab.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"load-data","dir":"Articles","previous_headings":"Beltran et al. 2016 PCA","what":"Load data","title":"Principal Component Analysis (PCA) Quickstart","text":"Raw text files can loaded read.delim passing URL.","code":"# Upper quartile normalized log2 transformed gene counts Beltran_log2UQ_exp <- Rubrary::rread(\"https://raw.githubusercontent.com/graeberlab-ucla/glab.library/master/vignettes/PCA_tutorial/Beltran_2016_rsem_genes_upper_norm_counts_coding_log2.txt\", row.names = 1)  rmarkdown::paged_table(Rubrary::corner(Beltran_log2UQ_exp))"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"run-pca","dir":"Articles","previous_headings":"Beltran et al. 2016 PCA","what":"Run PCA","title":"Principal Component Analysis (PCA) Quickstart","text":"Generally, scaling unnecessary log transformed gene expression features (genes) unit measure assumed scales relatively similar across genes. Centering always performed PCA result maximizing variance. See Standardization section PCA Walkthrough info.","code":"Beltran_PCA <- Rubrary::run_PCA(   df = Beltran_log2UQ_exp,   center = TRUE, scale = FALSE ) #> ** Cumulative var. exp. >= 80% at PC 18 (80.5%)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"plot-pca","dir":"Articles","previous_headings":"Beltran et al. 2016 PCA","what":"Plot PCA","title":"Principal Component Analysis (PCA) Quickstart","text":"annotations huge file associating large number samples cancer type abbreviation. dataset, samples correspond “CRPC”, castration resistant prostate cancer, “NEPC”, neuroendocrine prostate cancer. NEPC CRPC samples separate pretty nicely along PC2.  Lower PCs can visualized simultaneously Rubrary::plot_PCA_matrix. 3D view first three PCs.","code":"# Annotation file Beltran_info <- read.delim(\"https://raw.githubusercontent.com/graeberlab-ucla/glab.library/master/vignettes/PCA_tutorial/human.info.rsem.expression.txt\")  head(Beltran_info) #>            sample type #> 1 TCGA.05.4244.01 LUAD #> 2 TCGA.05.4249.01 LUAD #> 3 TCGA.05.4250.01 LUAD #> 4 TCGA.05.4382.01 LUAD #> 5 TCGA.05.4384.01 LUAD #> 6 TCGA.05.4389.01 LUAD Rubrary::plot_PCA(   df_pca = Beltran_PCA,   type = \"Scores\",   anno = Beltran_info,   annoname = \"sample\",   annotype = \"type\",   density = T, ellipse = T ) Rubrary::plot_PCA_matrix(   df_pca = Beltran_PCA,   PCs = c(1:5),   anno = Beltran_info,   annoname = \"sample\",   annotype = \"type\" ) #> Registered S3 method overwritten by 'GGally': #>   method from    #>   +.gg   ggplot2 Rubrary::plot_PCA_3D(   df_pca = Beltran_PCA,   PCs = c(1:3),   anno = Beltran_info,   annoname = \"sample\",   annotype = \"type\" )"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"varimax-rotation","dir":"Articles","previous_headings":"Beltran et al. 2016 PCA","what":"Varimax rotation","title":"Principal Component Analysis (PCA) Quickstart","text":"","code":"Beltran_PCA_VM <- Rubrary::rotate_varimax(Beltran_PCA, normalize = FALSE)  # Visualize scores Rubrary::plot_PCA(   df_pca = Beltran_PCA_VM$scores,   PCx = \"V1\", PCy = \"V2\",   title = \"Beltran 2016 PCA Scores (Varimax)\",   type = \"Scores\",   anno = Beltran_info,   annoname = \"sample\",   annotype = \"type\",   density = T, ellipse = T )"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"palmer-penguins-pca","dir":"Articles","previous_headings":"","what":"Palmer Penguins PCA","title":"Principal Component Analysis (PCA) Quickstart","text":"Using palmerpenguins dataset Allison Horst.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"load-data-1","dir":"Articles","previous_headings":"Palmer Penguins PCA","what":"Load data","title":"Principal Component Analysis (PCA) Quickstart","text":"Get palmerpenguins data add unique ID per entry.","code":"if (!requireNamespace(\"palmerpenguins\", quietly = TRUE)){   install.packages(\"palmerpenguins\") } library(palmerpenguins)  penguins <- penguins %>%   as.data.frame() %>%   mutate(Sample_ID = paste0(penguins_raw$`Individual ID`, \"_\", penguins_raw$`Sample Number`))    rownames(penguins) <- penguins$Sample_ID  rmarkdown::paged_table(penguins)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"run-pca-1","dir":"Articles","previous_headings":"Palmer Penguins PCA","what":"Run PCA","title":"Principal Component Analysis (PCA) Quickstart","text":"Subset data numeric , run PCA.","code":"num <- penguins %>%   dplyr::select(!c(species, island, sex, year, Sample_ID)) %>%   t() %>%   as.data.frame() %>%   dplyr::select(where(~!all(is.na(.x)))) # Filter out NAs    pca <- Rubrary::run_PCA(   df = num,   summary = T, tol = 0,   center = T, scale = T,   screeplot = T ) #> ** Cumulative var. exp. >= 80% at PC 2 (88.2%)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"plot-pca-1","dir":"Articles","previous_headings":"Palmer Penguins PCA","what":"Plot PCA","title":"Principal Component Analysis (PCA) Quickstart","text":"Use resulting prcomp object plot PCA scores annotating species metadata.  PCA scores plot, annotating sex metadata.  Plotting biplot view (standardized) PCs loadings plot.  Plot multiple PCs simultaneously. 3D view first three PCs.","code":"Rubrary::plot_PCA(   df_pca = pca,   anno = penguins,   annoname = \"Sample_ID\",   annotype = \"species\",   title = \"Palmer Penguins PCA Scores - Species\",   label = FALSE,   density = TRUE ) Rubrary::plot_PCA(   df_pca = pca,   anno = penguins,   annoname = \"Sample_ID\",   annotype = \"sex\",   title = \"Palmer Penguins PCA Scores - Sex\",   label = FALSE,   density = TRUE ) Rubrary::plot_PCA_biplot(   obj = pca,   anno = penguins,   annoname = \"Sample_ID\",   annotype = \"species\",   title = \"Palmer Penguins PCA Biplot - Species\",   label = \"Loadings\" ) Rubrary::plot_PCA_matrix(   df_pca = pca,   PCs = c(1:3),   anno = penguins,   annoname = \"Sample_ID\",   annotype = \"species\", ) Rubrary::plot_PCA_3D(   df_pca = pca,   PCs = c(1:3),   anno = penguins,   annoname = \"Sample_ID\",   annotype = \"species\", )"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Quickstart.html","id":"varimax-rotation-1","dir":"Articles","previous_headings":"Palmer Penguins PCA","what":"Varimax rotation","title":"Principal Component Analysis (PCA) Quickstart","text":"","code":"pca_vm <- Rubrary::rotate_varimax(pca)  # Visualize loadings Rubrary::plot_PCA(   df_pca = pca_vm$loadings,   PCx = \"V1\", PCy = \"V2\",   title = \"Palmer Penguins PCA Loadings (Varimax)\",   type = \"Loadings\",   label = TRUE ) # Visualize scores Rubrary::plot_PCA(   df_pca = pca_vm$scores,   PCx = \"V1\", PCy = \"V2\",   anno = penguins,   annoname = \"Sample_ID\",   annotype = \"species\",   title = \"Palmer Penguins PCA Scores (Varimax) - Species\",   label = FALSE,   density = TRUE,   type = \"Scores\" )"},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"background","dir":"Articles","previous_headings":"","what":"Background","title":"Principal Component Analysis (PCA) Walkthrough","text":"Heavily adapted Lindsay Smith’s PCA tutorial![1] HIGHLY recommend reading help develop intuitive understanding PCA, starting basic math prerequisites.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"why","dir":"Articles","previous_headings":"Background","what":"Why?","title":"Principal Component Analysis (PCA) Walkthrough","text":"Identify patterns high dimensional data Express data way highlight similarities + differences Patterns data “compressed” lower dimensions without much loss information Synonymous terms Dimension: feature, gene Sample: observation Adjusted: mean-adjusted, centered Scale: variance","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"variance","dir":"Articles","previous_headings":"Background > Statistics","what":"Variance","title":"Principal Component Analysis (PCA) Walkthrough","text":"Measure spread 1-dimensional data \\[var(X) = \\frac{\\Sigma_{=1}^n (X_i - \\bar{X})(X_i - \\bar{X})}{n-1}\\] \\(X_i\\): individual value \\(\\bar{X}\\): (sample) mean values \\(n\\): sample size","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"covariance","dir":"Articles","previous_headings":"Background > Statistics","what":"Covariance","title":"Principal Component Analysis (PCA) Walkthrough","text":"Found 2 dimensions Measure much dimensions vary mean respect \\(cov\\) btwn one dimension self variance \\(cov(X, Y) = cov(Y, X)\\) multiplication commutative \\[cov(X) = \\frac{\\Sigma_{=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y})}{n-1}\\] Interpretation Positive: dimensions increase together Negative: one dimension increases, decreases Zero: two dimensions independent ","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"covariance-matrix","dir":"Articles","previous_headings":"Background > Statistics","what":"Covariance matrix","title":"Principal Component Analysis (PCA) Walkthrough","text":"\\(n\\)-dimensional set: \\(\\frac{n!}{(n-2)! \\cdot 2}\\) total pairwise covariance values Represent covariances covariance matrix \\[C^{n \\times n} = (c_{, j}, c_{, j} = cov(Dim_i, Dim_j))\\] \\(C^{n \\times n}\\): matrix w/ \\(n\\) rows & \\(n\\) columns (square) \\(Dim_x\\): \\(x\\)th dimension Entry \\((2, 3)\\) covariance matrix \\(cov(Dim_2, Dim_3)\\) Main diagonal: variance dimension Symmetrical main diagonal Ex. Covariance matrix 3 dimensions/features \\(x\\), \\(y\\), \\(z\\) \\[C = \\pmatrix{ cov(x,x) = var(x) & cov(x,y) & cov(x,z) \\\\ cov(y,x) & cov(y,y) = var(y) & cov(y,z) \\\\ cov(z,x) & cov(z,y) & cov(z,z) = var(z)}\\]","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"eigenvectors","dir":"Articles","previous_headings":"Background > Matrix algebra","what":"Eigenvectors","title":"Principal Component Analysis (PCA) Walkthrough","text":"“Direction” part PCA decomposition, angle orthogonal “rotation” PCA amounts . square matrices eigenvectors \\(n \\times n\\) matrix w/ eigenvectors, \\(n\\) eigenvectors Length vector doesn’t affect ’s eigenvector , direction keep eigenvector standard, usually scale length = 1 (unit length) Can express data terms eigenvectors, instead expressing terms \\(x\\) \\(y\\) axes Core concept PCA! Non-eigenvector: \\[\\pmatrix{2 & 3 \\\\ 2 & 1} \\times \\pmatrix{1 \\\\ 3} = \\pmatrix{11 \\\\ 5}\\] Eigenvector: \\[\\pmatrix{2 & 3 \\\\ 2 & 1} \\times \\pmatrix{3 \\\\ 2} = \\pmatrix{12 \\\\ 8} = 4 \\times \\pmatrix{3 \\\\ 2}\\] Scaled eigenvector still eigenvector: \\[2 \\times \\pmatrix{3 \\\\ 2} = \\pmatrix{6 \\\\ 4}\\] \\[\\pmatrix{2 & 3 \\\\ 2 & 1} \\times \\pmatrix{6 \\\\ 4} = \\pmatrix{24 \\\\ 16} = 4 \\times \\pmatrix{6 \\\\ 4}\\] Scaling eigenvector unit length: Eigenvector: \\(\\pmatrix{3 \\\\ 2}\\) -> Length = \\(\\sqrt{(3^2 + 2^2)} = \\sqrt{13}\\) -> Scaled: \\(\\pmatrix{3 \\\\ 2} \\div \\sqrt{13} = \\pmatrix{\\frac{3}{\\sqrt{13}} \\\\ \\frac{2}{\\sqrt{13}}}\\)","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"eigenvalues","dir":"Articles","previous_headings":"Background > Matrix algebra","what":"Eigenvalues","title":"Principal Component Analysis (PCA) Walkthrough","text":"“Scale” part PCA decomposition Amount original vector scaled multiplication square matrix eigendecomposition example, eigenvalue = 4 Usually eigenvectors found machine solving, eigenvalues also returned","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"general-steps","dir":"Articles","previous_headings":"","what":"General steps","title":"Principal Component Analysis (PCA) Walkthrough","text":"Get \\(n\\)-dimensional data set Standardize data Calculate covariance matrix Calculate eigenvectors + eigenvalues covariance matrix Choose components + form feature vector Derive new data set","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"d-pca-walkthrough","dir":"Articles","previous_headings":"","what":"2D PCA walkthrough","title":"Principal Component Analysis (PCA) Walkthrough","text":"Replicating Lindsay Smith’s PCA tutorial [1], step step.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"get-n-dimensional-data-set","dir":"Articles","previous_headings":"2D PCA walkthrough","what":"Get \\(n\\)-dimensional data set","title":"Principal Component Analysis (PCA) Walkthrough","text":"2-dimensional / 2 features \\(x\\) dimension & \\(y\\) dimension Visualize original, unadjusted data","code":"Data <- data.frame(   x = c(2.5, 0.5, 2.2, 1.9, 3.1, 2.3, 2, 1, 1.5, 1.1),   y = c(2.4, 0.7, 2.9, 2.2, 3.0, 2.7, 1.6, 1.1, 1.6, 0.9) ) Data #>      x   y #> 1  2.5 2.4 #> 2  0.5 0.7 #> 3  2.2 2.9 #> 4  1.9 2.2 #> 5  3.1 3.0 #> 6  2.3 2.7 #> 7  2.0 1.6 #> 8  1.0 1.1 #> 9  1.5 1.6 #> 10 1.1 0.9 Rubrary::plot_scatter(   df = Data,   xval = \"x\", yval = \"y\",   title = \"Figure 3.1: Original PCA Data\",   guides = F, cormethod = \"none\" ) +   geom_vline(xintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_hline(yintercept = 0, linetype = \"dotted\", alpha = 0.25) +   scale_x_continuous(limits = c(-1, 4), expand = c(0, 0)) +   scale_y_continuous(limits = c(-1, 4), expand = c(0, 0))"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"standardize-adjust-data","dir":"Articles","previous_headings":"2D PCA walkthrough","what":"Standardize / adjust data","title":"Principal Component Analysis (PCA) Walkthrough","text":"\\(x - \\bar{x}\\), \\(y - \\bar{y}\\) Adjusted data set overall mean 0","code":"# Mean adjust / center DataAdjust <- Data %>%   scale(., center = T, scale = F) %>%   as.data.frame() DataAdjust #>        x     y #> 1   0.69  0.49 #> 2  -1.31 -1.21 #> 3   0.39  0.99 #> 4   0.09  0.29 #> 5   1.29  1.09 #> 6   0.49  0.79 #> 7   0.19 -0.31 #> 8  -0.81 -0.81 #> 9  -0.31 -0.31 #> 10 -0.71 -1.01"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"calculate-covariance-matrix","dir":"Articles","previous_headings":"2D PCA walkthrough","what":"Calculate covariance matrix","title":"Principal Component Analysis (PCA) Walkthrough","text":"","code":"# Covariance matrix cov_mtx <- cov(DataAdjust) cov_mtx #>           x         y #> x 0.6165556 0.6154444 #> y 0.6154444 0.7165556"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"eigendecomposition-of-covariance-matrix","dir":"Articles","previous_headings":"2D PCA walkthrough","what":"Eigendecomposition of covariance matrix","title":"Principal Component Analysis (PCA) Walkthrough","text":"Covariance matrix square -> can find eigenvectors + eigenvalues Eigenvectors unit eigenvectors","code":"# Eigenvalues eigenvalues = as.matrix(eigen(cov_mtx)$values) eigenvalues #>           [,1] #> [1,] 1.2840277 #> [2,] 0.0490834 # Eigenvectors eigenvectors = as.matrix(eigen(cov_mtx)$vectors) eigenvectors #>           [,1]       [,2] #> [1,] 0.6778734 -0.7351787 #> [2,] 0.7351787  0.6778734"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"choosing-components","dir":"Articles","previous_headings":"2D PCA walkthrough","what":"Choosing components","title":"Principal Component Analysis (PCA) Walkthrough","text":"2 dimensional data > \\(2 \\times 2\\) covariance matrix -> 2 eigenvectors Ordering eigenvectors highest lowest eigenvalues ordering significance larger dimensional data, can exclude uninformative / lower eigenvalue eigenvectors \\(FeatureVector = \\pmatrix{eig_1 & eig_2 & eig_3 & ... & eig_n}\\) Visualizing eigenvectors / PCs adjusted data Eigenvectors (colored dashed lines) perpendicular, lines characterize data Aligns maximum variance data, significant relationship btwn data dimensions 2nd largest eigenvalue PC2","code":"FeatureVector = cbind(eigenvectors[,1], eigenvectors[,2]) FeatureVector #>           [,1]       [,2] #> [1,] 0.6778734 -0.7351787 #> [2,] 0.7351787  0.6778734 Rubrary::plot_scatter(   df = DataAdjust, # Mean adjusted data   xval = \"x\", yval = \"y\",   title = \"Figure 3.2: Centered data w/ eigenvectors\",   guides = F, cormethod = \"none\" ) +   geom_vline(xintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_hline(yintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_abline(intercept = 0, linetype = \"dashed\", color = \"red\",               slope = eigenvectors[2,1] / eigenvectors[1,1]) + # EV 1 / PC1   geom_abline(intercept = 0, linetype = \"dashed\", color = \"blue\",               slope = eigenvectors[2,2] / eigenvectors[1,2]) + # EV 2 / PC2   scale_x_continuous(limits = c(-2, 2), expand = c(0, 0), breaks = seq(-2, 2, length.out = 9)) +   scale_y_continuous(limits = c(-2, 2), expand = c(0, 0), breaks = seq(-2, 2, length.out = 9))"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"deriving-new-data-set","dir":"Articles","previous_headings":"2D PCA walkthrough","what":"Deriving new data set","title":"Principal Component Analysis (PCA) Walkthrough","text":"final data (“scores”) can found using FeatureVector / selected eigenvectors rotate centered data. Visualizing final data PC1, now x-axis, along direction highest variance data PC2, now y-axis, orthogonal / perpendicular PC1 along direction 2nd highest variance data","code":"FinalData <- t(t(FeatureVector) %*% t(DataAdjust)) %>%   as.data.frame() %>%   dplyr::rename(PC1 = V1, PC2 = V2) FinalData #>            PC1         PC2 #> 1   0.82797019 -0.17511531 #> 2  -1.77758033  0.14285723 #> 3   0.99219749  0.38437499 #> 4   0.27421042  0.13041721 #> 5   1.67580142 -0.20949846 #> 6   0.91294910  0.17528244 #> 7  -0.09910944 -0.34982470 #> 8  -1.14457216  0.04641726 #> 9  -0.43804614  0.01776463 #> 10 -1.22382056 -0.16267529 PCA_scores_manual <- Rubrary::plot_scatter(   df = FinalData, # Mean adjusted data   xval = \"PC1\", yval = \"PC2\",   title = \"Figure 3.3: Data transformed with 2 eigenvectors\",   guides = F, cormethod = \"none\" ) +   geom_vline(xintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_hline(yintercept = 0, linetype = \"dotted\", alpha = 0.25) +   scale_x_continuous(limits = c(-2, 2), expand = c(0, 0),                      breaks = seq(-2, 2, length.out = 9)) +   scale_y_continuous(limits = c(-2, 2), expand = c(0, 0),                      breaks = seq(-2, 2, length.out = 9)) PCA_scores_manual"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"transforming-back-to-original-data","dir":"Articles","previous_headings":"2D PCA walkthrough","what":"Transforming back to original data","title":"Principal Component Analysis (PCA) Walkthrough","text":"","code":"RowFinalData = t(FinalData) RowDataAdjust_1 = solve(t(FeatureVector)) %*% RowFinalData RowDataAdjust_1 #>      [,1]  [,2] [,3] [,4] [,5] [,6]  [,7]  [,8]  [,9] [,10] #> [1,] 0.69 -1.31 0.39 0.09 1.29 0.49  0.19 -0.81 -0.31 -0.71 #> [2,] 0.49 -1.21 0.99 0.29 1.09 0.79 -0.31 -0.81 -0.31 -1.01 RowDataAdjust_2 = FeatureVector %*% RowFinalData RowDataAdjust_2 #>      [,1]  [,2] [,3] [,4] [,5] [,6]  [,7]  [,8]  [,9] [,10] #> [1,] 0.69 -1.31 0.39 0.09 1.29 0.49  0.19 -0.81 -0.31 -0.71 #> [2,] 0.49 -1.21 0.99 0.29 1.09 0.79 -0.31 -0.81 -0.31 -1.01 # \"Uncenter\" by adding back original means OriginalMean = c(mean(Data[,1]), mean(Data[,2])) OriginalData = t(RowDataAdjust_2) %>%   as.data.frame() %>%   dplyr::rename(x = V1, y = V2) %>%   mutate(x = x + OriginalMean[1],          y = y + OriginalMean[2]) OriginalData #>      x   y #> 1  2.5 2.4 #> 2  0.5 0.7 #> 3  2.2 2.9 #> 4  1.9 2.2 #> 5  3.1 3.0 #> 6  2.3 2.7 #> 7  2.0 1.6 #> 8  1.0 1.1 #> 9  1.5 1.6 #> 10 1.1 0.9 # Visualize recovered data Rubrary::plot_scatter(   df = OriginalData,   xval = \"x\", yval = \"y\",   title = \"Recovered Original PCA Data\",   guides = F, cormethod = \"none\" ) +   geom_vline(xintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_hline(yintercept = 0, linetype = \"dotted\", alpha = 0.25) +   scale_x_continuous(limits = c(-1, 4), expand = c(0, 0)) +   scale_y_continuous(limits = c(-1, 4), expand = c(0, 0))"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"rubrary","dir":"Articles","previous_headings":"2D PCA walkthrough","what":"Rubrary","title":"Principal Component Analysis (PCA) Walkthrough","text":"Rubrary::run_PCA wrapper stats::prcomp.","code":"PCA <- Rubrary::run_PCA(   df = t(Data), # 1 point per column   center = T, scale = F, tol = 0, screeplot = F ) # Visualize Rubrary::plot_PCA(   PCA,   title = \"PCA Scores\", ) +   geom_vline(xintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_hline(yintercept = 0, linetype = \"dotted\", alpha = 0.25) +   scale_x_continuous(limits = c(-2, 2), expand = c(0, 0),                      breaks = seq(-2, 2, length.out = 9)) +   scale_y_continuous(limits = c(-2, 2), expand = c(0, 0),                      breaks = seq(-2, 2, length.out = 9))"},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"scores","dir":"Articles","previous_headings":"PCA output","what":"Scores","title":"Principal Component Analysis (PCA) Walkthrough","text":"Coordinates individuals (observations) principal components Original data orthogonally rotated eigenvector directions stats::prcomp, x output","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"loadings","dir":"Articles","previous_headings":"PCA output","what":"Loadings","title":"Principal Component Analysis (PCA) Walkthrough","text":"Eigenvectors “inoculated” w/ info variability magnitude rotated data Association coefficients components + variables Loadings: covariances/correlations btwn original variables + unit-scaled components Generally use loadings instead eigenvectors interpreting components stats::prcomp, can use rotation output scaled/multiplied sdev output square roots eigenvalues covariance/correlation matrix","code":"loadings <- obj_prcomp$rotation %*% diag(obj_prcomp$sdev)"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"links","dir":"Articles","previous_headings":"PCA output > Loadings","what":"Links","title":"Principal Component Analysis (PCA) Walkthrough","text":"Cross Validated: Loadings vs eigenvectors PCA: use one another? Cross Validated: proper association measure variable PCA component? Cross Validated: interpret PCA loadings?","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"biplots","dir":"Articles","previous_headings":"PCA output","what":"Biplots","title":"Principal Component Analysis (PCA) Walkthrough","text":"PCA: singular value decomposition \\[X = USV^\\intercal\\] Examples based iris dataset thread:","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"biplot-scores","dir":"Articles","previous_headings":"PCA output > Biplots","what":"Biplot scores","title":"Principal Component Analysis (PCA) Walkthrough","text":"Two first principal components plotted scatter plot, .e. first column \\(\\bf{U}\\) plotted second column. Possible normalizations: Columns \\(\\bf{U}\\): principal components scaled unit sum squares Columns \\(\\bf{U}\\sqrt{n - 1}\\): standardized principal components (unit variance) prcomp object x output","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"biplot-loadings","dir":"Articles","previous_headings":"PCA output > Biplots","what":"Biplot loadings","title":"Principal Component Analysis (PCA) Walkthrough","text":"Original variables plotted arrows; .e. \\((x, y)\\) coordinates \\(\\)-th arrow endpoint given \\(\\)-th value first second column \\(\\bf{V}\\). Possible normalizations: Columns \\(\\bf{VS}\\): valid interpretation obj_prcomp$sdev square root corresponding eigenvalues Squared length \\(\\approx\\) variance Scalar products two arrows \\(\\approx\\) covariance Cosines angles arrows \\(\\approx\\) correlations original variables prcomp object rotation output","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"links-1","dir":"Articles","previous_headings":"PCA output > Biplots","what":"Links","title":"Principal Component Analysis (PCA) Walkthrough","text":"Stack Exchange: Positioning arrows PCA biplot Stack Exchange: Arrows underlying variables PCA biplot R","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"standardization","dir":"Articles","previous_headings":"","what":"Standardization","title":"Principal Component Analysis (PCA) Walkthrough","text":"Center feature means 0 Scale variance per feature unit variance general, standardize data (Z-score normalize) PCA!","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"centering","dir":"Articles","previous_headings":"Standardization","what":"Centering","title":"Principal Component Analysis (PCA) Walkthrough","text":"Principal components inevitably come origin PCA maximizes variance data preliminarily centered","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"centering-example","dir":"Articles","previous_headings":"Standardization > Centering","what":"Centering example","title":"Principal Component Analysis (PCA) Walkthrough","text":"Using transformed version previous 2D data set emphasize effect Center / mean adjust Reflect across y-axis (positive -> negative correlation) Uncenter Scatter plot shows result transformation. Red guide line fitted linear regression line.","code":"Data2 <- Data %>%   scale(., center = T) %>%   as.data.frame() %>%   mutate(x = -1 * x) %>%   mutate(x = x + OriginalMean[1],          y = y + OriginalMean[2]) Data2 #>            x         y #> 1  0.9312548 2.4888568 #> 2  3.4783424 0.4805781 #> 3  1.3133179 3.0795270 #> 4  1.6953811 2.2525887 #> 5  0.1671285 3.1976611 #> 6  1.1859635 2.8432589 #> 7  1.5680267 1.5437845 #> 8  2.8415705 0.9531143 #> 9  2.2047986 1.5437845 #> 10 2.7142161 0.7168462 Rubrary::plot_scatter(   df = Data2,   xval = \"x\", yval = \"y\",   title = \"Transformed PCA Data\",   guides = T, cormethod = \"none\" ) +   geom_vline(xintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_hline(yintercept = 0, linetype = \"dotted\", alpha = 0.25) +   scale_x_continuous(limits = c(-1, 4), expand = c(0, 0)) +   scale_y_continuous(limits = c(-1, 4), expand = c(0, 0))"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"pca-without-centering","dir":"Articles","previous_headings":"Standardization > Centering","what":"PCA without centering","title":"Principal Component Analysis (PCA) Walkthrough","text":"Plotting first eigenvector (dashed line) uncentered data shows 1st principal component piercing cloud points origin, along main direction cloud.","code":"PCA2_NoCenter <- Rubrary::run_PCA(   df = t(Data2), # 1 point per column   center = F, scale = F, tol = 0, screeplot = F ) # Extract eigenvectors evs_NoCenter <- PCA2_NoCenter$rotation Rubrary::plot_scatter(   df = Data2, # Uncentered data   xval = \"x\", yval = \"y\",   title = \"Uncentered data w/ PC1\",   guides = T, cormethod = \"none\" ) +   geom_vline(xintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_hline(yintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_abline(intercept = 0, linetype = \"dashed\",               slope = evs_NoCenter[2,1] / evs_NoCenter[1,1]) + # EV / PC 1   scale_x_continuous(limits = c(-1, 4), expand = c(0, 0)) +   scale_y_continuous(limits = c(-1, 4), expand = c(0, 0))"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"pca-with-centering","dir":"Articles","previous_headings":"Standardization > Centering","what":"PCA with centering","title":"Principal Component Analysis (PCA) Walkthrough","text":"centered data, first eigenvector (PC1) crosses origin along direction cloud points.","code":"PCA2_Center <- Rubrary::run_PCA(   df = t(Data2), # 1 point per column   center = T, scale = F, tol = 0, screeplot = F ) # Extract eigenvectors evs_Center <- PCA2_Center$rotation Rubrary::plot_scatter(   df = as.data.frame(scale(Data2, center = T)), # Centered data   xval = \"x\", yval = \"y\",   title = \"Centered data w/ PC1\",   guides = F, cormethod = \"none\" ) +   geom_vline(xintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_hline(yintercept = 0, linetype = \"dotted\", alpha = 0.25) +   geom_abline(intercept = 0, linetype = \"dashed\",               slope = evs_Center[2,1] / evs_Center[1,1]) + # EV / PC1   scale_x_continuous(limits = c(-2, 2), expand = c(0, 0)) +   scale_y_continuous(limits = c(-2, 2), expand = c(0, 0))"},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"links-2","dir":"Articles","previous_headings":"Standardization > Centering","what":"Links","title":"Principal Component Analysis (PCA) Walkthrough","text":"Cross Validated: centering data get rid intercept regression PCA? Cross Validated: centering make difference PCA (SVD eigen decomposition)?","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"scaling","dir":"Articles","previous_headings":"Standardization","what":"Scaling","title":"Principal Component Analysis (PCA) Walkthrough","text":"Somewhat subjective depending ’re interested investigating. scaling: performing PCA covariance matrix Generally okay variable scales similar variables unit measure Scaling: performing PCA correlation matrix Generally preferred variable scales different variables different unit measure PCA correlation mtx PCA standardization variable","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"links-3","dir":"Articles","previous_headings":"Standardization > Scaling","what":"Links","title":"Principal Component Analysis (PCA) Walkthrough","text":"Cross Validated: PCA correlation covariance?","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"varimax","dir":"Articles","previous_headings":"","what":"Varimax","title":"Principal Component Analysis (PCA) Walkthrough","text":"ttnphns Stack Exchange!!","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/articles/PCA_Walkthrough.html","id":"links-4","dir":"Articles","previous_headings":"Varimax","what":"Links","title":"Principal Component Analysis (PCA) Walkthrough","text":"Cross Validated: compute varimax-rotated principal components R? REALLY GOOD ANSWERS explaining math + consequences rotation raw scores + eigenvectors vs. std scores + loadings amoeba answer ttnphns answer Cross Validated: obtain unstandardized scores factor analysis (FA)?","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yi Jou (Ruby) Liao. Author, maintainer.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Liao Y (2023). Rubrary: Ruby's functions & notes. https://liaoyjruby.github.io/Rubrary/, https://github.com/liaoyjruby/Rubrary.","code":"@Manual{,   title = {Rubrary: Ruby's functions & notes},   author = {Yi Jou (Ruby) Liao},   year = {2023},   note = {https://liaoyjruby.github.io/Rubrary/, https://github.com/liaoyjruby/Rubrary}, }"},{"path":"https://liaoyjruby.github.io/Rubrary/index.html","id":"rubrary","dir":"","previous_headings":"","what":"Ruby's functions & notes","title":"Ruby's functions & notes","text":"Personal functions, mostly usage Graeber Lab OV project analysis workflows test R package building. functions subject sudden changes. Installing package install many packages used throughout Graeber lab analyses. Certain packages installed listed “Suggested” may prompted installation upon running relevant function.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Ruby's functions & notes","text":"can install development version Rubrary GitHub :","code":"if (!require(\"devtools\", quietly = TRUE))     install.packages(\"devtools\")  devtools::install_github(\"liaoyjruby/Rubrary\")"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/GSEA_pathways.html","id":null,"dir":"Reference","previous_headings":"","what":"Pathways from msigdbr to use with fgsea — GSEA_pathways","title":"Pathways from msigdbr to use with fgsea — GSEA_pathways","text":"Broad set pathways extracted msigdbr database formatted list, names gene set names values vectors genes given gene set.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/GSEA_pathways.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pathways from msigdbr to use with fgsea — GSEA_pathways","text":"","code":"GSEA_pathways"},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/GSEA_pathways.html","id":"gsea-pathways","dir":"Reference","previous_headings":"","what":"GSEA_pathways","title":"Pathways from msigdbr to use with fgsea — GSEA_pathways","text":"list 10,481 gene sets","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/GSEA_pathways.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Pathways from msigdbr to use with fgsea — GSEA_pathways","text":"https://www.gsea-msigdb.org/gsea/msigdb/human/collection_details.jsp","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/GSEA_pathways.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Pathways from msigdbr to use with fgsea — GSEA_pathways","text":"Includes Human MSigDB Collections: C2CP: curated gene sets, canonical pathways C5GO: ontology gene sets, Gene Ontology gene sets BP: GO Biological Process ontology CC: GO Cellular Component ontology MF: GO Molecular Function ontology H: hallmark gene sets","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/airway_deseq_res.html","id":null,"dir":"Reference","previous_headings":"","what":"Airway Dex Treated vs. Untreated DESeq2 Results — airway_deseq_res","title":"Airway Dex Treated vs. Untreated DESeq2 Results — airway_deseq_res","text":"airway package data run DESeq2 analyze differential gene expression dexamethasone treated untreated airway smooth muscle cells. Original gene names converted Ensembl ID HGNC symbol filtered protein-coding BioMart database.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/airway_deseq_res.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Airway Dex Treated vs. Untreated DESeq2 Results — airway_deseq_res","text":"","code":"airway_deseq_res"},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/airway_deseq_res.html","id":"airway-deseq-res","dir":"Reference","previous_headings":"","what":"airway_deseq_res","title":"Airway Dex Treated vs. Untreated DESeq2 Results — airway_deseq_res","text":"data frame 16,460 rows 9 columns: ensembl_gene_id, hgnc_symbol Gene names Ensembl ID HGNC symbol format baseMean Average normalized count values, dividing size factors, taken samples log2FoldChange, lfcSE Effect size estimate, log base 2 scale standard error stat Value test statistic pvalue, padj P-value adjusted P-value sign_log_p Log base 2 p-value multiplied sign","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/airway_deseq_res.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Airway Dex Treated vs. Untreated DESeq2 Results — airway_deseq_res","text":"https://bioconductor.org/packages/release/data/experiment/html/airway.html","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/assess_integration.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute and plot integration assessment cell-specific methods for Seurat object — assess_integration","title":"Compute and plot integration assessment cell-specific methods for Seurat object — assess_integration","text":"Wrapper application single cell integration assessment metrics default parameters. Takes Seurat object, calculates integration assessment metric per cell given grouping variables, plots visualization metrics. single integration score per dataset can reported median metric across cells.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/assess_integration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute and plot integration assessment cell-specific methods for Seurat object — assess_integration","text":"","code":"assess_integration(   sobj,   group.var,   method = c(\"LISI\", \"MixingMetric\", \"CellMixS\"),   reduction = c(\"umap\", \"pca\", \"tsne\"),   k = 300,   MM_flip = TRUE,   title = NULL,   savename = NULL,   width = NULL,   height = NULL )  run_LISI(   sobj,   group.var,   reduction = c(\"umap\", \"pca\", \"tsne\"),   title = NULL,   savename = NULL,   width = NULL,   height = NULL )  run_MixingMetric(   sobj,   group.var,   MM_flip = TRUE,   reduction = c(\"umap\", \"pca\", \"tsne\"),   k = 300,   title = NULL,   savename = NULL,   width = NULL,   height = NULL )  run_CellMixS(   sobj,   group.var,   reduction = c(\"umap\", \"pca\", \"tsne\"),   k = 300,   title = NULL,   savename = NULL,   width = NULL,   height = NULL )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/assess_integration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute and plot integration assessment cell-specific methods for Seurat object — assess_integration","text":"sobj Seurat object group.var character (vector mm lisi); metadata colname check level integration method c(\"LISI\", \"MixingMetric\", \"CellMixS\"); integration assessment metric apply reduction c(\"umap\", \"pca\", \"tsne\"); dimensional reduction method k integer; max.k Seurat::MixingMetric, k CellMixS::cms MM_flip logical; use max.k - MixingMetric instead MixingMetric title string; plot title savename string; filepath save results figure (ext.) width numeric; plot width height numeric; plot height","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/assess_integration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute and plot integration assessment cell-specific methods for Seurat object — assess_integration","text":"Dataframe integration assessment values","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/assess_integration.html","id":"local-inverse-simpson-s-index-lisi-neighborhood-batch-diversity","dir":"Reference","previous_headings":"","what":"Local inverse Simpson's index lisi: neighborhood batch diversity","title":"Compute and plot integration assessment cell-specific methods for Seurat object — assess_integration","text":"Wrapper immunogenomics/LISI Harmony paper. Quantifies diversity batches within local neighborhoods, defined kNN graphs, using inverse Simpson's index. LISI = 1: neighborhood comprised single group, mixed LISI = # groups: neighborhood equal number cells datasets, perfect mixing","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/assess_integration.html","id":"seurat-mixingmetric-mm-local-group-knn-ranking","dir":"Reference","previous_headings":"","what":"Seurat MixingMetric mm: local / group kNN ranking","title":"Compute and plot integration assessment cell-specific methods for Seurat object — assess_integration","text":"Wrapper Seurat::MixingMetric Seurat v3 paper (Stuart et al. 2019). Assesses local neighborhood composition cell well mixed neighborhood . neighborhood well mixed, contain least cells dataset. Can intuitive high MixingMetric mean good mixing, range can flipped max.k - MixingMetric. Uses flipped scale (MM_flip = TRUE) default. MixingMetric = max.k, low max.k - MixingMetric: mixed Low MixingMetric, high max.k - MixingMetric: well mixed Set-wide metric: median (mean) MixingMetric distribution Implemented max.k = 300 default.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/assess_integration.html","id":"cellmixs-cms-batch-specific-distance-distribution-knn-test","dir":"Reference","previous_headings":"","what":"CellMixS cms: batch-specific distance distribution kNN test","title":"Compute and plot integration assessment cell-specific methods for Seurat object — assess_integration","text":"Wrapper CellMixS::cms (Lütge et al. 2021). Tests cell hypothesis batch-specific distance distributions towards k-nearest neighboring (knn) cells derived unspecified underlying distribution using Anderson-Darling test. Low cms: poorly mixed per cell neighborhood High cms: well mixed per cell neighborhood Set-wide metric: cms histogram, flat random batch mixing skewed towards 0 batch related bias Implementation uses k = 300 dim_red = reduction. per CellMixS vignette, k exceed size smallest cell population. Takes run, asks BiocParallel use BiocParallel::MulticoreParam(). Computer may churn runs...","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/assess_integration.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Compute and plot integration assessment cell-specific methods for Seurat object — assess_integration","text":"run_LISI(): Compute plot local inverse Simpson's index lisi run_MixingMetric(): Compute plot Seurat MixingMetric mm run_CellMixS(): Compute plot CellMixS cms","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/calc_sumZscore.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Sum Z Score — calc_sumZscore","title":"Generate Sum Z Score — calc_sumZscore","text":"Slightly modified Favour's function OV project","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/calc_sumZscore.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Sum Z Score — calc_sumZscore","text":"","code":"calc_sumZscore(df, sig, topn = length(sig), botn = NA)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/calc_sumZscore.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Sum Z Score — calc_sumZscore","text":"df numeric dataframe (e.g gene expression df); rownames contain name genes/features signature sig vector/list genes (applicable, list ordered enriched genes top & de-enriched genes bottom) topn numeric; genes top signature consider botn numeric; genes bottom signature consider","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/calc_sumZscore.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Sum Z Score — calc_sumZscore","text":"scores samples using signature genes","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/cbind.fill.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine data.frames by column, filling in missing rows. — cbind.fill","title":"Combine data.frames by column, filling in missing rows. — cbind.fill","text":"cbinds list dataframes filling missing rows NA. Based https://stackoverflow.com//7962980","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/cbind.fill.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine data.frames by column, filling in missing rows. — cbind.fill","text":"","code":"# S3 method for fill cbind(...)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/cbind.fill.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine data.frames by column, filling in missing rows. — cbind.fill","text":"... input data frames column bind together","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/cbind.fill.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine data.frames by column, filling in missing rows. — cbind.fill","text":"single data frame","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/check_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Shapiro-Wilk test of normality — check_normal","title":"Shapiro-Wilk test of normality — check_normal","text":"Uses stats::shapiro.test perform test normality outputs interpretation console.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/check_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shapiro-Wilk test of normality — check_normal","text":"","code":"check_normal(values, alpha = 0.05)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/check_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Shapiro-Wilk test of normality — check_normal","text":"values numeric vector alpha numeric; p-value threshold significance","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/check_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Shapiro-Wilk test of normality — check_normal","text":"Logical SW normality test result; message","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/check_normal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Shapiro-Wilk test of normality — check_normal","text":"null hypothesis S-W test sample comes normally distributed population. p-value less chosen alpha level, null hypothesis rejected, indicating data non-normal distribution.","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/check_normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Shapiro-Wilk test of normality — check_normal","text":"","code":"set.seed(13) check_normal(rnorm(100)) #> Shapiro-Wilk normality test: p-value = 0.273 #> ** p = 0.273 > 0.05; normal #> [1] TRUE"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/convert_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert list of genes via BioMart — convert_genes","title":"Convert list of genes via BioMart — convert_genes","text":"See biomaRT::listAttributes(mart) list options from_to.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/convert_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert list of genes via BioMart — convert_genes","text":"","code":"convert_genes(   genes,   from_to = c(\"ensembl_gene_id\", \"hgnc_symbol\"),   mart = NULL,   table = FALSE )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/convert_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert list of genes via BioMart — convert_genes","text":"genes char vector; genes from_to length 2 char vector; 1st value current format (ex. ensemb_gene_id), 2nd value desired format (ex. hgnc_symbol) mart biomaRt Mart object table logical; T return conversion table","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/convert_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert list of genes via BioMart — convert_genes","text":"char vector converted gene list desired format","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/corner.html","id":null,"dir":"Reference","previous_headings":"","what":"Like head but just the corner — corner","title":"Like head but just the corner — corner","text":"Like head just corner","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/corner.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Like head but just the corner — corner","text":"","code":"corner(df, n = 10)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/corner.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Like head but just the corner — corner","text":"df dataframe n integer; number rows = columns display","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/corner.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Like head but just the corner — corner","text":"Top left n x n submatrix df","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/corner.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Like head but just the corner — corner","text":"","code":"corner(diag(15)) #>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] #>  [1,]    1    0    0    0    0    0    0    0    0     0 #>  [2,]    0    1    0    0    0    0    0    0    0     0 #>  [3,]    0    0    1    0    0    0    0    0    0     0 #>  [4,]    0    0    0    1    0    0    0    0    0     0 #>  [5,]    0    0    0    0    1    0    0    0    0     0 #>  [6,]    0    0    0    0    0    1    0    0    0     0 #>  [7,]    0    0    0    0    0    0    1    0    0     0 #>  [8,]    0    0    0    0    0    0    0    1    0     0 #>  [9,]    0    0    0    0    0    0    0    0    1     0 #> [10,]    0    0    0    0    0    0    0    0    0     1"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/filter_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter dataframe by list of (protein coding) genes — filter_genes","title":"Filter dataframe by list of (protein coding) genes — filter_genes","text":"Filter dataframe list (protein coding) genes","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/filter_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter dataframe by list of (protein coding) genes — filter_genes","text":"","code":"filter_genes(   df,   genes_filt = Rubrary::get_PC_genes(),   gene_col = NULL,   search = FALSE )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/filter_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter dataframe by list of (protein coding) genes — filter_genes","text":"df dataframe; gene names gene_col rownames dataframe genes_filt char vector; (protein coding) genes include / filter gene_col string; colnames genes, assumed rownames(df) NULL search logical; TRUE use Seurat::UpdateSymbolList match gene symbols better","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/filter_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter dataframe by list of (protein coding) genes — filter_genes","text":"dataframe gene rownames filtered protein coding ","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/filter_genes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter dataframe by list of (protein coding) genes — filter_genes","text":"","code":"df = data.frame(   gene = c(\"geneA\", \"geneB\", \"geneC\", \"geneD\"),   sampA = c(1, 2, 3, 4),   sampB = c(2, 3, 4, 5),   sampC = c(3, 4, 5, 6) ) df_filt <- Rubrary::filter_genes(df, genes_filt = c(\"geneB\", \"geneC\"), gene_col = \"gene\")"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/format_GSEA_name.html","id":null,"dir":"Reference","previous_headings":"","what":"Format GSEA pathway name — format_GSEA_name","title":"Format GSEA pathway name — format_GSEA_name","text":"Strips prepended database abbreviation, changes underscores spaces, converts title case.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/format_GSEA_name.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format GSEA pathway name — format_GSEA_name","text":"","code":"format_GSEA_name(   pw,   ignore = NULL,   source = FALSE,   split = FALSE,   split_nchar = 40 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/format_GSEA_name.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format GSEA pathway name — format_GSEA_name","text":"pw string char vector; MSigDB pathway names ignore char vector; terms leave uppercase (ex. DNA, RNA) instead title case source logical; T append source parens end name split logical; T (roughly) split long names multiple lines split_nchar integer; split = TRUE, max number characters per line","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/format_GSEA_name.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format GSEA pathway name — format_GSEA_name","text":"Nicer looking title-case'd pathway name","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/format_GSEA_name.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Format GSEA pathway name — format_GSEA_name","text":"","code":"format_GSEA_name(\"DATABASE_DNA_REPAIR\") #> [1] \"DNA Repair\" format_GSEA_name(\"DATABASE_DNA_REPAIR_THIS_IS_A_REALLY_LONG_PATHWAY\", split = TRUE) #> [[1]] #> [1] \"DNA Repair this is a Really Long Pathway\" #>"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/full_join_rownames.html","id":null,"dir":"Reference","previous_headings":"","what":"Full join by rownames — full_join_rownames","title":"Full join by rownames — full_join_rownames","text":"Wrapper dplyr::full_join merge rownames.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/full_join_rownames.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Full join by rownames — full_join_rownames","text":"","code":"full_join_rownames(df1, df2)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/full_join_rownames.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Full join by rownames — full_join_rownames","text":"df1 Numerical dataframe rownames df2 Numerical dataframe rownames","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/full_join_rownames.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Full join by rownames — full_join_rownames","text":"Full-joined dataframe rownames rownames","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/genecoexp_scatter_hyper.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot pairwise gene coexpression scatter and calculate hypergeometric enrichment p-value between two genelists — genecoexp_scatter_hyper","title":"Plot pairwise gene coexpression scatter and calculate hypergeometric enrichment p-value between two genelists — genecoexp_scatter_hyper","text":"Plot pairwise gene coexpression scatter calculate hypergeometric enrichment p-value two genelists","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/genecoexp_scatter_hyper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot pairwise gene coexpression scatter and calculate hypergeometric enrichment p-value between two genelists — genecoexp_scatter_hyper","text":"","code":"genecoexp_scatter_hyper(   seuobj,   df_dense = NULL,   genesA,   genesB,   group = NULL,   savepath,   ncols = NULL )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/genecoexp_scatter_hyper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot pairwise gene coexpression scatter and calculate hypergeometric enrichment p-value between two genelists — genecoexp_scatter_hyper","text":"seuobj Seurat object df_dense dataframe; dense gene expression matrix Seurat (cells rows, genes columns) genesA char vector; list genes genesB char vector; list genes group string; metadata value group savepath string; path choose title sans extension ncols integer; number columns grid","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/genecoexp_scatter_hyper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot pairwise gene coexpression scatter and calculate hypergeometric enrichment p-value between two genelists — genecoexp_scatter_hyper","text":"dataframe hypergeometric test p-values","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_GSEAsq_terms.html","id":null,"dir":"Reference","previous_headings":"","what":"Get GSEA Squared terms/keywords — get_GSEAsq_terms","title":"Get GSEA Squared terms/keywords — get_GSEAsq_terms","text":"Get GSEA Squared terms/keywords","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_GSEAsq_terms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get GSEA Squared terms/keywords — get_GSEAsq_terms","text":"","code":"get_GSEAsq_terms(   df_GSEA,   savename = NULL,   filt_freq = c(5, 500),   signlogp_base = 10,   rep0 = .Machine$double.xmin,   verbose = TRUE,   plot = TRUE,   plot_pval = 1e-05,   plot_fmt = \"png\",   seed = 13 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_GSEAsq_terms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get GSEA Squared terms/keywords — get_GSEAsq_terms","text":"df_GSEA df/string; (path ) GSEA results pathway NES columns savename string; path save output , extension filt_freq num vector; frequency filter terms, filt_freq[1] minimum frequency, filt_freq[2] maximum frequency signlogp_base integer; log base calculating signed log_base p metric rep0 numeric; value replace pval == 0 results , use rep0 = 2.2e-16 (rounded .Machine$double.eps) original function verbose logical; TRUE output terms KS p-value calculated plot logical; TRUE output barplot significant terms plot_pval numeric; include terms pval <= plot_pval barplot plot_fmt string; file extension save plot seed numeric; randomization seed","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_GSEAsq_terms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get GSEA Squared terms/keywords — get_GSEAsq_terms","text":"df w/ terms, frequency, (KS) pval, signed enrichment score, signlogp","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_GSEAsq_terms.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get GSEA Squared terms/keywords — get_GSEAsq_terms","text":"","code":"library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union # Load data deseq_stats <- setNames(   airway_deseq_res[,\"sign_log_p\"],   airway_deseq_res[,\"hgnc_symbol\"] ) pthwys <- GSEA_pathways # Run (f)gsea gsea_results <- fgsea::fgsea(   pathways = pthwys,   stats = deseq_stats,   eps = 0.0,   minSize = 15,   maxSize  = 500) %>%   arrange(NES) #> Warning: There are ties in the preranked stats (6.92% of the list). #> The order of those tied genes will be arbitrary, which may produce unexpected results. # Get terms head(Rubrary::get_GSEAsq_terms(gsea_results, verbose = FALSE))  #>            Term Freq         pval         ES signedlogp #> 1     METABOLIC  256 1.998401e-15 -0.2663684 -14.699317 #> 2           DNA  130 1.895151e-12  0.3408557  11.722356 #> 3 MORPHOGENESIS  110 4.767242e-11  0.3370141  10.321733 #> 4          GENE   14 1.939423e-10  0.2515788   9.712327 #> 5         LIPID   55 8.623270e-10 -0.3655041  -9.064328 #> 6   DEVELOPMENT  219 8.624648e-10  0.2228497   9.064259"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_PC_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve protein coding genes from Ensembl BioMart — get_PC_genes","title":"Retrieve protein coding genes from Ensembl BioMart — get_PC_genes","text":"Retrieve protein coding genes Ensembl BioMart","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_PC_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve protein coding genes from Ensembl BioMart — get_PC_genes","text":"","code":"get_PC_genes(mart = NULL)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_PC_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve protein coding genes from Ensembl BioMart — get_PC_genes","text":"mart biomaRt Mart object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_PC_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve protein coding genes from Ensembl BioMart — get_PC_genes","text":"character vector protein coding genes","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_PC_genes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve protein coding genes from Ensembl BioMart — get_PC_genes","text":"","code":"# head(Rubrary::get_PC_genes())"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_gene_desc.html","id":null,"dir":"Reference","previous_headings":"","what":"Get gene description from BioMart — get_gene_desc","title":"Get gene description from BioMart — get_gene_desc","text":"Get gene description BioMart","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_gene_desc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get gene description from BioMart — get_gene_desc","text":"","code":"get_gene_desc(   genes,   attrs = c(\"hgnc_symbol\", \"description\"),   clean_desc = TRUE,   mart = NULL,   verbose = FALSE )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_gene_desc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get gene description from BioMart — get_gene_desc","text":"genes character vector; genes interest attrs character vector; valid attributes biomaRt::listAttributes(mart) clean_desc logical; T remove \"[Source: ...]\" description field mart Mart object; generate one provided verbose logical; output biomaRt messages console","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_gene_desc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get gene description from BioMart — get_gene_desc","text":"dataframe attrs columns, populated BioMart","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_gene_desc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get gene description from BioMart — get_gene_desc","text":"","code":"genes <- c(\"POU5F1\", \"SOX2\", \"KLF4\", \"MYC\") # \\donttest{   head(Rubrary::get_gene_desc(genes)) #>   hgnc_symbol                                    description #> 1        KLF4                    KLF transcription factor 4  #> 2         MYC MYC proto-oncogene, bHLH transcription factor  #> 3      POU5F1                        POU class 5 homeobox 1  #> 4        SOX2                SRY-box transcription factor 2  # }"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_kspval.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate (signed) Kolgomorov-Smirnov enrichment p-value in dataframe — get_kspval","title":"Calculate (signed) Kolgomorov-Smirnov enrichment p-value in dataframe — get_kspval","text":"group interest specified, pulls first condition others.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_kspval.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate (signed) Kolgomorov-Smirnov enrichment p-value in dataframe — get_kspval","text":"","code":"get_kspval(   df,   value,   group,   goi = NULL,   rep0 = .Machine$double.xmin,   signed = FALSE,   viz = FALSE )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_kspval.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate (signed) Kolgomorov-Smirnov enrichment p-value in dataframe — get_kspval","text":"df df; columns value group, NA values filtered value string; colname values rank group string; colname categorizations goi group interest value within df[,group] rep0 numeric; value replace 0 results signed logical; TRUE return GSEA-style enrichment score second element list: ks_pval[1] = pval, ks_pval[1] = ES viz logical; TRUE output density plot values","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_kspval.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate (signed) Kolgomorov-Smirnov enrichment p-value in dataframe — get_kspval","text":"Kolgomorov-Smirnov enrichment p-value & enrichment score","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_kspval.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate (signed) Kolgomorov-Smirnov enrichment p-value in dataframe — get_kspval","text":"Signed ES score adapted franapoli/signed-ks-test based GSEA enrichment score calculation. Positive ES indicates rank, goi \"left\" / smaller rest values, negative ES indicates goi \"right\" / greater rest values. Use viz = TRUE visualize values resulting KS p-value.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_kspval.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate (signed) Kolgomorov-Smirnov enrichment p-value in dataframe — get_kspval","text":"","code":"set.seed(13) df = data.frame(   group = c(rep(\"A\", 50), rep(\"B\",50)),   values = c(rnorm(50, mean = 0), rnorm(50, mean = 2))) Rubrary::get_kspval(df, value = \"values\", group = \"group\", goi = \"A\", signed = TRUE) #> $pval #> [1] 8.759313e-13 #>  #> $ES #> [1] 0.72 #>"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_loadings.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract loadings from prcomp object — get_loadings","title":"Extract loadings from prcomp object — get_loadings","text":"Scales PCA decomposition eigenvectors (rotation output prcomp) square root corresponding eigenvalues (sdev output prcomp).","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_loadings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract loadings from prcomp object — get_loadings","text":"","code":"get_loadings(obj_prcomp)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_loadings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract loadings from prcomp object — get_loadings","text":"obj_prcomp prcomp object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_loadings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract loadings from prcomp object — get_loadings","text":"Matrix PCA loadings","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_loadings.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract loadings from prcomp object — get_loadings","text":"","code":"data(iris) PCA_iris <- Rubrary::run_PCA(t(iris[,c(1:4)])) #> ** Cumulative var. exp. >= 80% at PC 1 (92.5%)  Rubrary::get_loadings(PCA_iris) #>                     PC1         PC2         PC3         PC4 #> Sepal.Length  0.7431080 -0.32344628  0.16277024  0.04870686 #> Sepal.Width  -0.1738010 -0.35968937 -0.16721151 -0.04936083 #> Petal.Length  1.7615451  0.08540619 -0.02132015 -0.07408051 #> Petal.Width   0.7367389  0.03718318 -0.15264701  0.11635429"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_log_coding_geneexp.html","id":null,"dir":"Reference","previous_headings":"","what":"Get log(x+1) protein coding gene expression matrix — get_log_coding_geneexp","title":"Get log(x+1) protein coding gene expression matrix — get_log_coding_geneexp","text":"Get log(x+1) protein coding gene expression matrix","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_log_coding_geneexp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get log(x+1) protein coding gene expression matrix — get_log_coding_geneexp","text":"","code":"get_log_coding_geneexp(   exp,   base = 2,   pc_genes = Rubrary::get_PC_genes(),   savename = NULL )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_log_coding_geneexp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get log(x+1) protein coding gene expression matrix — get_log_coding_geneexp","text":"exp df/string; samples columns, genes rows base integer; log transformation base pc_genes char vector; list coding genes filter savename string; filename save output ","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/get_log_coding_geneexp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get log(x+1) protein coding gene expression matrix — get_log_coding_geneexp","text":"Log(x+1) transformed protein coding gene expression dataframe","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/inst_pkg.html","id":null,"dir":"Reference","previous_headings":"","what":"Prompt user to install package — inst_pkg","title":"Prompt user to install package — inst_pkg","text":"Helper function \"Rubrary::use_pkg\"","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/inst_pkg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prompt user to install package — inst_pkg","text":"","code":"inst_pkg(pkg, strict = FALSE)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/inst_pkg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prompt user to install package — inst_pkg","text":"pkg string; package name (CRAN Bioconductor) strict logical; strict requirement package install?","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/inst_pkg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prompt user to install package — inst_pkg","text":"None","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/left_join_rownames.html","id":null,"dir":"Reference","previous_headings":"","what":"Left join by rownames — left_join_rownames","title":"Left join by rownames — left_join_rownames","text":"Wrapper dplyr::left_join merge rownames. dataframes matching rownames","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/left_join_rownames.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Left join by rownames — left_join_rownames","text":"","code":"left_join_rownames(df1, df2)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/left_join_rownames.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Left join by rownames — left_join_rownames","text":"df1 Numerical dataframe rownames df2 Numerical dataframe rownames","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/left_join_rownames.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Left join by rownames — left_join_rownames","text":"Left-joined dataframe rownames rownames","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/output_DESeq.html","id":null,"dir":"Reference","previous_headings":"","what":"Output DESeq results as dataframe with signed log p metric — output_DESeq","title":"Output DESeq results as dataframe with signed log p metric — output_DESeq","text":"Filters sign_log_p == NA rows.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/output_DESeq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Output DESeq results as dataframe with signed log p metric — output_DESeq","text":"","code":"output_DESeq(DE_results, logbase = 2, savename = NULL, rank = FALSE)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/output_DESeq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Output DESeq results as dataframe with signed log p metric — output_DESeq","text":"DE_results DESeqDataSet object logbase numeric; base log sign log_base p metric savename string; filepath save table rank logical; TRUE output .rnk file compatible GSEA Java app","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/output_DESeq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Output DESeq results as dataframe with signed log p metric — output_DESeq","text":"Dataframe DESeq results including signed log p metric","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/phyper_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Hypergeometric test, 0 vs. non-0, on columns of a dataframe — phyper_df","title":"Hypergeometric test, 0 vs. non-0, on columns of a dataframe — phyper_df","text":"Originally used scRNA gene co-expression analysis","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/phyper_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hypergeometric test, 0 vs. non-0, on columns of a dataframe — phyper_df","text":"","code":"phyper_df(df, A, B)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/phyper_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hypergeometric test, 0 vs. non-0, on columns of a dataframe — phyper_df","text":"df dataframe; includes columns \"\" \"B\" string; colname values B string; colname values B","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/phyper_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hypergeometric test, 0 vs. non-0, on columns of a dataframe — phyper_df","text":"single dataframe row &B names, phyper inputs, pvalues","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_DEgene_boxplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot gene expression boxplots of selected genes (from DESeq signature) — plot_DEgene_boxplot","title":"Plot gene expression boxplots of selected genes (from DESeq signature) — plot_DEgene_boxplot","text":"Great sanity checking, make sure differentially expressed genes reported DE gene analysis metrics (DESeq2) reflected gene expression data per sample.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_DEgene_boxplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot gene expression boxplots of selected genes (from DESeq signature) — plot_DEgene_boxplot","text":"","code":"plot_DEgene_boxplot(   data,   anno,   anno_sig,   anno_type = NULL,   sig_DE,   genes = NULL,   metric = \"sign_log_p\",   pval = FALSE,   genes_n = 6,   colors = NULL,   title = NULL,   savename = NULL,   height = 8,   width = 8 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_DEgene_boxplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot gene expression boxplots of selected genes (from DESeq signature) — plot_DEgene_boxplot","text":"data df/string; (path ) numeric gene expression matrix, rownames = genes, colnames = samples anno df/string; (path ) annotation table, rownames = samples, columns = metadata anno_sig string; colname anno used breaks x-axis anno_type string; colname anno used color jitter points sig_DE df/string, optional; (path ) DE(seq) gene results table genes char vector; list genes plot, must present data metric string; colname sig_DE rank genes auto gene selection genes provided appending gene name parens pval logical; use t.test pvalue annotation via ggsignif::stat_signif genes_n integer; genes provided, get top/bottom genes_n colors char vector; jitter point colors, length == # unique anno_types title string; plot title savename string; file path save plot height numeric; plot height width numeric; plot width","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_DEgene_boxplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot gene expression boxplots of selected genes (from DESeq signature) — plot_DEgene_boxplot","text":"ggplot object, facet-wrapped boxplot","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_DEgene_boxplot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot gene expression boxplots of selected genes (from DESeq signature) — plot_DEgene_boxplot","text":"Providing DE(seq) gene signature (sig_DE) optional; provided, genes list must defined. DE gene info provided, subplot's title metric value appended parenthesis.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_barplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot GSEA NES barplot — plot_GSEA_barplot","title":"Plot GSEA NES barplot — plot_GSEA_barplot","text":"Can plot barplot NES pathways one GSEA result, compare NES chosen pathways two GSEA results.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_barplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot GSEA NES barplot — plot_GSEA_barplot","text":"","code":"plot_GSEA_barplot(   gsea_res,   gsea_name = \"GSEA\",   gsea_pws = NULL,   n_pws = 5,   pw_format = FALSE,   pw_split = FALSE,   pw_source = TRUE,   pw_ignore = NULL,   pw_size = 5,   gsea2_res = NULL,   gsea2_name = NULL,   order2 = FALSE,   ptrn2 = \"none\",   NES_cutoff = NULL,   sig_cutoff = NULL,   colors = c(\"firebrick\", \"darkblue\"),   title = NULL,   savename = NULL,   width = 10,   height = NULL )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_barplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot GSEA NES barplot — plot_GSEA_barplot","text":"gsea_res df/string; (path ) GSEA results w/ pathway NES columns gsea_name string; description GSEA results gsea_pws char vector; pathways GSEA results plot n_pws integer; pathways provided, top/bottom n pathways (ordered NES) plot pw_format logical; clean pathway names? pw_split logical; T split pathway names multiple lines pw_source logical; T append pathway source parenthesis pw_ignore char vector; list terms ignore name formatting pw_size numeric; pathway name text size gsea2_res df/string; (path ) 2nd GSEA results w/ pathway NES columns gsea2_name string; description 2nd GSEA results order2 logical; order pathways NES 2nd GSEA results? ptrn2 string; ggpattern pattern arg: 'stripe', 'crosshatch', 'point', 'circle', 'none' NES_cutoff numeric; value draw NES cutoff line sig_cutoff vector; sig_cutoff[1] colname significance values (\"pval\" \"padj\"), sig_cutoff[2] numeric cutoff value: higher value, alpha 0.5. Ex. sig_cutoff = c(\"pval\", 0.05) sig_cutoff = c(\"padj\", 0.1) colors vector; colors[1] positive bar color, colors[2] negative bar color title string; plot title savename string; file path save plot width numeric; plot width height numeric; plot height","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_barplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot GSEA NES barplot — plot_GSEA_barplot","text":"GSEA NES barplot ggplot object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot GSEA pathway plots (waterfall + enrichment) — plot_GSEA_pathway","title":"Plot GSEA pathway plots (waterfall + enrichment) — plot_GSEA_pathway","text":"subtitle specified, Kolmogorov-Smirnov enrichment p-value calculated check genes pathway separate genes chosen pathway based ranking desired rankcol.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot GSEA pathway plots (waterfall + enrichment) — plot_GSEA_pathway","text":"","code":"plot_GSEA_pathway(   sig,   geneset,   genecol = \"gene\",   rankcol,   rankcol_name = rankcol,   hightolow = FALSE,   label = length(geneset) < 20,   legendpos = \"none\",   hl_color = \"firebrick3\",   lab_high = NULL,   lab_low = NULL,   hllab = \"Highlight\",   title = NULL,   subtitle = NULL,   savename = NULL )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot GSEA pathway plots (waterfall + enrichment) — plot_GSEA_pathway","text":"sig df/string; (path ) dataframe genecol + rankcol columns geneset vector; list genes genecol string; colname gene names sig rankcol string; colname values sig rankcol_name string; descriptive name values hightolow logical; T high values left, low right label logical; T label highlighted genes legendpos vector; value btwn 0-1 legend coordinates (ggplot2 legend.position) hl_color string; color highlight lab_high string; description high values lab_low string; description low values hllab string; description highlighted values title string; plot title subtitle string; plot subtitle; !! overwrites p-val_enrichment savename string; filepath save png ","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot GSEA pathway plots (waterfall + enrichment) — plot_GSEA_pathway","text":"grid gene set enrichment waterfall enrichment plot","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot GSEA pathway plots (waterfall + enrichment) — plot_GSEA_pathway","text":"","code":"airway_deseq = Rubrary::airway_deseq_res genes = Rubrary::GSEA_pathways$GOBP_REGULATION_OF_GLUCOSE_IMPORT Rubrary::plot_GSEA_pathway(   sig = airway_deseq,   geneset = genes,   genecol = \"hgnc_symbol\",   rankcol = \"sign_log_p\",   rankcol_name = \"Sign log p value\",   lab_high = \"\\U2191 in treated\\n\\U2193 in untreated\",   lab_low = \"\\U2191 in untreated\\n\\U2193 in treated\",   hllab = \"Highlight genes\",   title = \"Airway Treated vs. Untreated DESeq - Glucose Import Regulation Genes\" )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway_batch.html","id":null,"dir":"Reference","previous_headings":"","what":"plot_GSEA_pathway wrapper that works nicely with lapply — plot_GSEA_pathway_batch","title":"plot_GSEA_pathway wrapper that works nicely with lapply — plot_GSEA_pathway_batch","text":"plot_GSEA_pathway wrapper works nicely lapply","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway_batch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot_GSEA_pathway wrapper that works nicely with lapply — plot_GSEA_pathway_batch","text":"","code":"plot_GSEA_pathway_batch(   path_name,   pthwys,   sig,   genecol = \"gene\",   rankcol,   rankcol_name = rankcol,   hllab = \"Pathway genes\",   hightolow = FALSE,   format_name = TRUE,   ignore_name = NULL,   lab_low = NULL,   lab_high = NULL,   legendpos = c(0.5, 0.2),   hl_color = \"firebrick3\",   label = length(pthwys[[path_name]]) < 50,   savedir = NULL,   sig_name = \"\" )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway_batch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot_GSEA_pathway wrapper that works nicely with lapply — plot_GSEA_pathway_batch","text":"path_name string; name pathway pthwys named list; key = geneset name, values = char vector genes geneset sig dataframe; signature genecol string; colname gene names sig rankcol string; colname values rank rankcol_name string; descriptor rankcol hllab string; descriptor highlighted genes hightolow logical; T high values left, low right format_name logical; T run pathway name Rubrary::format_GSEA_name ignore_name char vector; phrases exclude title case Rubrary::format_GSEA_name lab_low string; label low rankcol values lab_high string; label high rankcol values legendpos vector; value btwn 0-1 legend coordinates (ggplot2 legend.position) hl_color string; color highlight label logical; T label points plot savedir string; directory path saving plot sig_name string; name signature append save path","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway_batch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot_GSEA_pathway wrapper that works nicely with lapply — plot_GSEA_pathway_batch","text":"Gene set enrichment plot ggplot object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEA_pathway_batch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot_GSEA_pathway wrapper that works nicely with lapply — plot_GSEA_pathway_batch","text":"","code":"airway_deseq = Rubrary::airway_deseq_res pathways <- Rubrary::GSEA_pathways pws_plot <- c(\"HALLMARK_ADIPOGENESIS\", \"GOCC_POSTSYNAPTIC_MEMBRANE\") lapply(   pws_plot,   Rubrary::plot_GSEA_pathway_batch,   pthwys = pathways,   sig = airway_deseq,   genecol = \"hgnc_symbol\",   rankcol = \"sign_log_p\",   rankcol_name = \"Sign log p value\",   lab_high = \"\\U2191 in treated\\n\\U2193 in untreated\",   lab_low = \"\\U2191 in untreated\\n\\U2193 in treated\", ) #> [[1]]  #>  #> [[2]]  #>"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEAsq_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot categorical percentile rank comparison between two GSEA squared signatures — plot_GSEAsq_density","title":"Plot categorical percentile rank comparison between two GSEA squared signatures — plot_GSEAsq_density","text":"Plot categorical percentile rank comparison two GSEA squared signatures","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEAsq_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot categorical percentile rank comparison between two GSEA squared signatures — plot_GSEAsq_density","text":"","code":"plot_GSEAsq_density(   GSEAsq_df1,   GSEAsq_df2,   name1,   name2,   plot_pval = TRUE,   cat_order = NULL,   title = \"GSEA Squared\",   colors = c(\"firebrick\", \"lightslateblue\"),   rug = TRUE,   savename = NULL,   plot_fmt = \"png\",   height = 8,   width = 8 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEAsq_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot categorical percentile rank comparison between two GSEA squared signatures — plot_GSEAsq_density","text":"GSEAsq_df1 df/string; \"gsea_squared-df.txt\" df path GSEAsq result 1 GSEAsq_df2 df/string; \"gsea_squared-df.txt\" df path GSEAsq result 2 name1 string; descriptor GSEAsq result 1 name2 string; descriptor GSEAsq result 2 plot_pval logical; TRUE include KS p-value per category plot cat_order vector; desired order GSEAsq categories title string; overall plot title colors vector; first color signify result 1, second result 2 rug logical; TRUE rugplot density plot savename string; filepath save outputs (extension) plot_fmt string; file extension save plot height numeric; plot height width numeric; plot width","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_GSEAsq_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot categorical percentile rank comparison between two GSEA squared signatures — plot_GSEAsq_density","text":"facet wrapped ggplot object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot PCA with annotation — plot_PCA","title":"Plot PCA with annotation — plot_PCA","text":"Plot PCA annotation","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot PCA with annotation — plot_PCA","text":"","code":"plot_PCA(   df_pca,   anno = NULL,   PCx = \"PC1\",   PCy = \"PC2\",   type = c(\"Scores\", \"Loadings\"),   annoname = \"Sample\",   annolabel = annoname,   label = FALSE,   annotype = \"Type\",   annotype2 = NULL,   ellipse = FALSE,   ks_pval = c(\"none\", \"caption\", \"grob\"),   highlight = NULL,   colors = NULL,   col_midpt = 0,   title = NULL,   subtitle = NULL,   density = FALSE,   savename = NULL,   width = 8,   height = 8 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot PCA with annotation — plot_PCA","text":"df_pca string prcomp obj; (path ) PCA output anno string df; Annotation info DF PCx string; Component x-axis PCy string; Component y-axis type c(\"Score\", \"Loading\") annoname string; Colname anno matching point name annolabel string; Colname anno label points , defaults annoname label logical; T label points annotype string; Colname anno info color annotype2 string; Colname anno info change shape ellipse logical; Draw ggplot2::stat_ellipse data ellipse w/ default params - confidence ellipse ks_pval c(\"none\", \"caption\", \"grob\"); Display ks-pvalue caption grob highlight char vector; Specific points shape differently & label colors char vector; discrete annotype, length number unique annotypes. continuous annotype, can either length 2 colors[1] low colors[2] high length 3 diverging colorscale colors[1] = low, colors[2] = mid, colors[3] = high. col_midpt numeric; continuous length(colors) == 3 scale_color_gradientn usage title string; Plot title subtitle string; Subtitle plot density logical; Show density plot along axes; requires group annotations provided savename string; File path save plot width numeric; Saved plot width height numeric; Saved plot height","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot PCA with annotation — plot_PCA","text":"PCA output plotted annotation","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot PCA with annotation — plot_PCA","text":"","code":"data(iris) iris$Sample = rownames(iris) PCA_iris <- Rubrary::run_PCA(t(iris[,c(1:4)])) #> ** Cumulative var. exp. >= 80% at PC 1 (92.5%)  # Scores Rubrary::plot_PCA(   df_pca = PCA_iris,   anno = iris[,c(\"Sample\", \"Species\")],   annoname = \"Sample\", annotype = \"Species\",   title = \"Iris PCA Scores by Species\",   subtitle = \"Centered & scaled\",   ellipse = TRUE )  # Loadings Rubrary::plot_PCA(   df_pca = PCA_iris,   type = \"Loadings\",   title = \"Iris PCA Loadings\",   subtitle = \"Centered & scaled\",   label = TRUE )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_3D.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot 3D PCA scores/loadings via plotly — plot_PCA_3D","title":"Plot 3D PCA scores/loadings via plotly — plot_PCA_3D","text":"Image saving requires kaleido python package setup via reticulate R package. See ?plotly::save_image details setup instructions. Pass savename html file extension avoid errors.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot 3D PCA scores/loadings via plotly — plot_PCA_3D","text":"","code":"plot_PCA_3D(   df_pca,   PCs = c(1:3),   type = c(\"Scores\", \"Loadings\"),   anno = NULL,   annoname = \"Sample\",   annotype = \"Type\",   annolabel = annoname,   label = FALSE,   colors = NULL,   title = NULL,   savename = NULL,   rotate = FALSE,   width = 10,   height = 10 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot 3D PCA scores/loadings via plotly — plot_PCA_3D","text":"df_pca string prcomp obj; (path ) PCA output PCs num vector; list numeric PCs plot (ex. c(1:3) first 3 PCs) type c(\"Score\", \"Loading\") anno string/df; Annotation info df_pca annoname, annotype, annolabel columns annoname string; Colname anno matching point name annotype string; Colname anno info color annolabel string; Colname anno label points , defaults annoname label logical; T label points colors char vector; discrete annotype, length number unique annotypes length 2 continuous annotypes colors[1] represents low values colors[2] represents high values. title string; Plot title savename string; File path save plot , html image format rotate logical; T HTML widget automatically rotate opened. applicable savename NULL width numeric; Saved plot width height numeric; Saved plot height saving image format","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_3D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot 3D PCA scores/loadings via plotly — plot_PCA_3D","text":"plotly object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_3D.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot 3D PCA scores/loadings via plotly — plot_PCA_3D","text":"","code":"data(iris) iris$Sample = rownames(iris) plot_PCA_3D(   df_pca = Rubrary::run_PCA(t(iris[,c(1:4)]), screeplot = FALSE),   PCs = c(1:3),   type = \"Scores\",   anno = iris[,c(\"Sample\", \"Species\")],   annoname = \"Sample\", annotype = \"Species\",   title = \"Iris PCA Scores 3D\" )  {\"x\":{\"visdat\":{\"1b796aeedf1d\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"1b796aeedf1d\",\"attrs\":{\"1b796aeedf1d\":{\"mode\":\"markers\",\"x\":{},\"y\":{},\"z\":{},\"showlegend\":true,\"color\":{},\"colors\":[\"#F8766D\",\"#00BA38\",\"#619CFF\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\"},\"1b796aeedf1d.1\":{\"mode\":\"markers\",\"x\":{},\"y\":{},\"z\":{},\"showlegend\":false,\"color\":{},\"colors\":[\"#F8766D\",\"#00BA38\",\"#619CFF\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\",\"marker\":{\"size\":7,\"line\":{\"color\":\"black\",\"opacity\":0.5,\"width\":1}},\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"xaxis\":{\"title\":\"PC1 (92.46%)\"},\"yaxis\":{\"title\":\"PC2 (5.31%)\"},\"zaxis\":{\"title\":\"PC3 (1.71%)\"}},\"title\":\"Iris PCA Scores 3D\",\"legend\":{\"title\":{\"text\":\"Species\"}},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"mode\":\"markers\",\"x\":[-2.6841256259695352,-2.7141416872943243,-2.8889905690592954,-2.7453428556414088,-2.7287165365545287,-2.2808596328444906,-2.8205377507406078,-2.6261449731466318,-2.8863827317805519,-2.6727557978209524,-2.5069470906518547,-2.6127552309087219,-2.7861092661880162,-3.2238037438656511,-2.6447503899420282,-2.3860390335311319,-2.6235278752244251,-2.6482967062543801,-2.1998203236175784,-2.5879863998787673,-2.3102562152425166,-2.5437052287571551,-3.2159394156486107,-2.3027331822262056,-2.3557540491237714,-2.5066689069258206,-2.4688200731213379,-2.5623199061960147,-2.6395347153845412,-2.6319893872743449,-2.587398476689351,-2.4099324970021736,-2.6488623343499107,-2.5987367491005857,-2.6369268781057977,-2.8662416521186684,-2.6252380498503713,-2.8006841154482203,-2.9805020437819922,-2.5900063139680949,-2.7701024260279006,-2.8493687050431022,-2.997406546594906,-2.4056144850974843,-2.2094892377836781,-2.7144514267577065,-2.5381482589989388,-2.8394621676428491,-2.5430857498303916,-2.7033597823351583],\"y\":[-0.31939724658510144,0.17700122506478014,0.14494942608555739,0.31829897925191603,-0.32675451293492036,-0.74133044906291556,0.089461384528568666,-0.16338495969832903,0.578311754186704,0.11377424587411666,-0.64506889864857431,-0.014729939161374777,0.23511200020171835,0.5113945870063823,-1.1787646364375759,-1.3380623304006536,-0.81067951418125839,-0.31184914459335511,-0.8728390389622116,-0.51356030874927749,-0.39134593565389458,-0.43299606327902868,-0.133468069538526,-0.098708854814099661,0.03728185967738222,0.14601688049526751,-0.13095148943525065,-0.36771885743420035,-0.31203998023528323,0.19696122492431448,0.20431849127413329,-0.41092426422957329,-0.81336382029696286,-1.0931457594493579,0.121322347865863,-0.069364471580080786,-0.59937002137942408,-0.26864373779798267,0.48795834442861535,-0.22904383682701293,-0.26352753374425686,0.9409605736411969,0.34192605747160981,-0.18887142893026074,-0.43666314163918846,0.25020820418521106,-0.50377114446143811,0.22794556949382763,-0.57941002151988985,-0.10770608249941191],\"z\":[0.027914827589413632,0.21046427237824353,-0.017900256320890456,-0.031559373605681534,-0.090079240551201339,-0.16867765820910458,-0.25789215825561829,0.021879317886719457,-0.020759570264780619,0.1976327249881461,0.075318009379120282,-0.10215025995659013,0.20684443044964418,-0.061299672457099608,0.15162752361780971,-0.27777690270313532,-0.13818322788071918,-0.026668315612593984,0.12030552339473115,-0.21366517222471582,0.2394440432449533,-0.20845723241671504,-0.29239675074524246,-0.039123258742880938,-0.12502108270287907,0.25342004234465726,-0.094910576099392061,0.078494205137924183,0.1459088957300291,-0.0407710790671795,0.077222989073435416,0.14552497200513081,-0.22566914972011937,-0.15781081295821978,0.14304958178613861,0.16433230665302542,0.26835037569393644,-0.093699082479800244,-0.072927045692692954,0.080082303017325912,-0.077247693161104039,0.34923037730596579,-0.1925092117127101,-0.26386794551341575,-0.29874274575510867,0.097678144045629064,-0.16670563660480456,-0.083726849033593759,0.017115024248513272,0.089294008478824433],\"showlegend\":true,\"type\":\"scatter3d\",\"name\":\"setosa\",\"marker\":{\"color\":\"rgba(248,118,109,1)\",\"line\":{\"color\":\"rgba(248,118,109,1)\"}},\"textfont\":{\"color\":\"rgba(248,118,109,1)\"},\"error_y\":{\"color\":\"rgba(248,118,109,1)\"},\"error_x\":{\"color\":\"rgba(248,118,109,1)\"},\"line\":{\"color\":\"rgba(248,118,109,1)\"},\"frame\":null},{\"mode\":\"markers\",\"x\":[1.284825688858354,0.93248853231232087,1.4643023219913964,0.1833177199583729,1.0881032577116683,0.64166908425808,1.0950606626324493,-0.74912266982965525,1.044131826053438,-0.0087454040828936954,-0.50784088383532378,0.51169855744759984,0.26497650811204881,0.98493451047089275,-0.17392537168176564,0.92786078094424995,0.66028376169693948,0.2361049933176739,0.94473372801981581,0.045226976298702128,1.1162831773500523,0.35788841799730969,1.2981838753589163,0.92172892244703941,0.71485332591141404,0.90017437317216975,1.332024436722091,1.557802155066073,0.81329064981754395,-0.30558377802430686,-0.068126492068361341,-0.18962247237849972,0.13642871155801722,1.3800264359155134,0.58800644333986596,0.80685831250041473,1.2206908824443554,0.81509523576660226,0.24595767988669479,0.16641321714545915,0.46480028840378157,0.8908151984694519,0.23054802355945769,-0.7045317592446616,0.3569814947010494,0.3319344799450607,0.37621565106667276,0.6425760075543403,-0.90646986494883397,0.29900084187814563],\"y\":[-0.68516047046730955,-0.31833363826262961,-0.50426281530920503,0.82795901182063203,-0.074590675197716769,0.41824687156867829,-0.28346827006152986,1.0048909611818955,-0.22836189978839622,0.72308190500483405,1.2659711905263935,0.10398123549903991,0.55003646368047454,0.12481785412635681,0.25485420870258896,-0.46717949444151136,0.35296966572384997,0.33361076682491503,0.54314555077976623,0.58383437747186417,0.084616852194787373,0.068925031656013491,0.32778730833391695,0.18273779362136691,-0.14905594436978531,-0.32850447383432396,-0.24444087601634412,-0.26749544731025543,0.16335030068761575,0.36826218975458774,0.70517213179946514,0.68028676352813322,0.31403243824923643,0.4209542873138814,0.48428741998121788,-0.19418231471315156,-0.40761959361100797,0.37203705990950142,0.26852439662201444,0.68192672486362638,0.6707115445117201,0.034464444368268239,0.40438584800732486,1.0122482275317142,0.50491009333710835,0.21265468378116933,0.29321892925141846,-0.017738190112416855,0.75609336659901405,0.34889780645033552],\"z\":[0.40656802546769399,0.018014186646239945,0.33832576498089589,0.17959139187535453,0.30775789623478433,-0.041076090823956656,-0.16981023986057561,-0.012302919237596209,0.41533608475939726,-0.28114143117641061,0.26981718276885164,-0.1305477502404867,0.69414683014441836,0.062114408322260527,-0.090457690725705059,0.31462097583217202,-0.32802752837859583,0.27116183725106618,0.49951904648511208,0.23500210497205515,-0.45962099135910461,0.22985388760895104,0.34785435225730749,0.23107177773628423,0.32180093724447351,0.31620907371157381,0.5217027796644188,0.16492098374357991,-0.035424504846160741,0.31849158062304639,0.24421381043355372,0.30642056121765765,0.1772427660112437,-0.016167127520729494,-0.44443349863980852,-0.38896306309821105,0.23716700988387537,0.61472084259182158,-0.18836681164619531,0.060009225855337356,0.024306855718950981,0.0099469328943483266,0.22941024143915595,0.1056911489030188,-0.016617170198266199,-0.083204290895677213,-0.077996351087676233,0.20539496698326026,0.012599647557889398,-0.010581660495571268],\"showlegend\":true,\"type\":\"scatter3d\",\"name\":\"versicolor\",\"marker\":{\"color\":\"rgba(0,186,56,1)\",\"line\":{\"color\":\"rgba(0,186,56,1)\"}},\"textfont\":{\"color\":\"rgba(0,186,56,1)\"},\"error_y\":{\"color\":\"rgba(0,186,56,1)\"},\"error_x\":{\"color\":\"rgba(0,186,56,1)\"},\"line\":{\"color\":\"rgba(0,186,56,1)\"},\"frame\":null},{\"mode\":\"markers\",\"x\":[2.531192727803631,1.415235876703905,2.6166760159956928,1.9715310530434382,2.3500059200446426,3.3970387360532612,0.52123224390977607,2.9325870689936919,2.321228816573381,2.9167509667860756,1.661774153636534,1.8034019529650938,2.1655917960801476,1.3461635794584539,1.5859282238732235,1.9044563747934296,1.9496890593990719,3.4870553642902822,3.7956454220728872,1.3007917126376596,2.4278179130660482,1.1990011054655629,3.4999200389245408,1.3887661316914679,2.2754305038722076,2.6140904738108341,1.2585081605114903,1.2911320591150235,2.1236087227738976,2.3880030160034704,2.8416727781038733,3.2306736614320952,2.1594376424890527,1.444161242329512,1.7812948100451147,3.0764999316871906,2.1442433143020847,1.9050981488140784,1.1693263393415028,2.1076111432572446,2.3141547052356026,1.9222678009026037,1.415235876703905,2.5630133750774786,2.418746182732828,1.9441097945469707,1.52716661481452,1.7643457170444317,1.9009416142184261,1.3901888619479164],\"y\":[0.0098491094988011618,0.57491634754648901,-0.34390315134173521,0.17972790435224476,0.040260947142530285,-0.5508366730280565,1.1927587270006452,-0.35550000297749734,0.24383150231069003,-0.78279194881527958,-0.24222840775506779,0.21563761733355485,-0.2162755850740255,0.7768183473443393,0.53964071402671832,-0.11925069209197341,-0.041943259663212148,-1.1757393297134309,-0.25732297342048038,0.76114963643506317,-0.37819601261705155,0.60609152775793007,-0.4606740989118962,0.20439932735215041,-0.33499060582167828,-0.56090135512307882,0.17970479472274611,0.11666865117401083,0.20972947667730213,-0.46463980470873734,-0.37526916719510417,-1.3741650867930491,0.21727757866904848,0.1434134104575801,0.49990168107813593,-0.68808567757117667,-0.14006420108979073,-0.049300526013030962,0.16499026202310901,-0.37228787196079854,-0.18365127916901977,-0.40920346681606296,0.57491634754648901,-0.27786260292919557,-0.30479819785469286,-0.18753230280060593,0.37531698258048801,-0.078858854518476448,-0.11662795851202444,0.28266093799054998],\"z\":[-0.76016542724589609,-0.29632252738796533,0.11078788321910843,-0.10842466246342365,-0.28538956318444203,0.34843755579746699,-0.54565929564681381,0.4202399357679677,0.34830439493484422,-0.42333541768255883,-0.24244018972576958,0.037648168231481781,-0.033326641844325822,-0.28190288211846576,-0.62902932640801146,-0.47963981962659125,-0.044186167630122633,-0.13389487393609831,0.51376776381780398,0.3449950383134171,-0.21911932430194381,-0.51185550869700192,0.57318224256800232,0.064522756631267594,-0.28615009116915036,0.20553452435362451,-0.045847703927250641,-0.2312564626599711,-0.15418002392883084,0.44953019194184946,0.49889807587076818,0.11454820547541915,-0.20876316713083845,0.15323388806308944,0.17287518911341901,0.33559229243454058,-0.73487893672551163,-0.16218023577073762,-0.28183584020848107,-0.027291132141631261,-0.32269374717305971,-0.11358659579935715,-0.29632252738796533,-0.29256952459674335,-0.50448266397718056,-0.17782509063265811,0.1218981718671809,-0.13048163128784876,-0.72325156348991781,-0.36290964808537646],\"showlegend\":true,\"type\":\"scatter3d\",\"name\":\"virginica\",\"marker\":{\"color\":\"rgba(97,156,255,1)\",\"line\":{\"color\":\"rgba(97,156,255,1)\"}},\"textfont\":{\"color\":\"rgba(97,156,255,1)\"},\"error_y\":{\"color\":\"rgba(97,156,255,1)\"},\"error_x\":{\"color\":\"rgba(97,156,255,1)\"},\"line\":{\"color\":\"rgba(97,156,255,1)\"},\"frame\":null},{\"mode\":\"markers\",\"x\":[-2.6841256259695352,-2.7141416872943243,-2.8889905690592954,-2.7453428556414088,-2.7287165365545287,-2.2808596328444906,-2.8205377507406078,-2.6261449731466318,-2.8863827317805519,-2.6727557978209524,-2.5069470906518547,-2.6127552309087219,-2.7861092661880162,-3.2238037438656511,-2.6447503899420282,-2.3860390335311319,-2.6235278752244251,-2.6482967062543801,-2.1998203236175784,-2.5879863998787673,-2.3102562152425166,-2.5437052287571551,-3.2159394156486107,-2.3027331822262056,-2.3557540491237714,-2.5066689069258206,-2.4688200731213379,-2.5623199061960147,-2.6395347153845412,-2.6319893872743449,-2.587398476689351,-2.4099324970021736,-2.6488623343499107,-2.5987367491005857,-2.6369268781057977,-2.8662416521186684,-2.6252380498503713,-2.8006841154482203,-2.9805020437819922,-2.5900063139680949,-2.7701024260279006,-2.8493687050431022,-2.997406546594906,-2.4056144850974843,-2.2094892377836781,-2.7144514267577065,-2.5381482589989388,-2.8394621676428491,-2.5430857498303916,-2.7033597823351583],\"y\":[-0.31939724658510144,0.17700122506478014,0.14494942608555739,0.31829897925191603,-0.32675451293492036,-0.74133044906291556,0.089461384528568666,-0.16338495969832903,0.578311754186704,0.11377424587411666,-0.64506889864857431,-0.014729939161374777,0.23511200020171835,0.5113945870063823,-1.1787646364375759,-1.3380623304006536,-0.81067951418125839,-0.31184914459335511,-0.8728390389622116,-0.51356030874927749,-0.39134593565389458,-0.43299606327902868,-0.133468069538526,-0.098708854814099661,0.03728185967738222,0.14601688049526751,-0.13095148943525065,-0.36771885743420035,-0.31203998023528323,0.19696122492431448,0.20431849127413329,-0.41092426422957329,-0.81336382029696286,-1.0931457594493579,0.121322347865863,-0.069364471580080786,-0.59937002137942408,-0.26864373779798267,0.48795834442861535,-0.22904383682701293,-0.26352753374425686,0.9409605736411969,0.34192605747160981,-0.18887142893026074,-0.43666314163918846,0.25020820418521106,-0.50377114446143811,0.22794556949382763,-0.57941002151988985,-0.10770608249941191],\"z\":[0.027914827589413632,0.21046427237824353,-0.017900256320890456,-0.031559373605681534,-0.090079240551201339,-0.16867765820910458,-0.25789215825561829,0.021879317886719457,-0.020759570264780619,0.1976327249881461,0.075318009379120282,-0.10215025995659013,0.20684443044964418,-0.061299672457099608,0.15162752361780971,-0.27777690270313532,-0.13818322788071918,-0.026668315612593984,0.12030552339473115,-0.21366517222471582,0.2394440432449533,-0.20845723241671504,-0.29239675074524246,-0.039123258742880938,-0.12502108270287907,0.25342004234465726,-0.094910576099392061,0.078494205137924183,0.1459088957300291,-0.0407710790671795,0.077222989073435416,0.14552497200513081,-0.22566914972011937,-0.15781081295821978,0.14304958178613861,0.16433230665302542,0.26835037569393644,-0.093699082479800244,-0.072927045692692954,0.080082303017325912,-0.077247693161104039,0.34923037730596579,-0.1925092117127101,-0.26386794551341575,-0.29874274575510867,0.097678144045629064,-0.16670563660480456,-0.083726849033593759,0.017115024248513272,0.089294008478824433],\"showlegend\":false,\"type\":\"scatter3d\",\"marker\":{\"color\":\"rgba(248,118,109,1)\",\"size\":7,\"line\":{\"color\":\"black\",\"opacity\":0.5,\"width\":1}},\"name\":\"setosa\",\"textfont\":{\"color\":\"rgba(248,118,109,1)\"},\"error_y\":{\"color\":\"rgba(248,118,109,1)\"},\"error_x\":{\"color\":\"rgba(248,118,109,1)\"},\"line\":{\"color\":\"rgba(248,118,109,1)\"},\"frame\":null},{\"mode\":\"markers\",\"x\":[1.284825688858354,0.93248853231232087,1.4643023219913964,0.1833177199583729,1.0881032577116683,0.64166908425808,1.0950606626324493,-0.74912266982965525,1.044131826053438,-0.0087454040828936954,-0.50784088383532378,0.51169855744759984,0.26497650811204881,0.98493451047089275,-0.17392537168176564,0.92786078094424995,0.66028376169693948,0.2361049933176739,0.94473372801981581,0.045226976298702128,1.1162831773500523,0.35788841799730969,1.2981838753589163,0.92172892244703941,0.71485332591141404,0.90017437317216975,1.332024436722091,1.557802155066073,0.81329064981754395,-0.30558377802430686,-0.068126492068361341,-0.18962247237849972,0.13642871155801722,1.3800264359155134,0.58800644333986596,0.80685831250041473,1.2206908824443554,0.81509523576660226,0.24595767988669479,0.16641321714545915,0.46480028840378157,0.8908151984694519,0.23054802355945769,-0.7045317592446616,0.3569814947010494,0.3319344799450607,0.37621565106667276,0.6425760075543403,-0.90646986494883397,0.29900084187814563],\"y\":[-0.68516047046730955,-0.31833363826262961,-0.50426281530920503,0.82795901182063203,-0.074590675197716769,0.41824687156867829,-0.28346827006152986,1.0048909611818955,-0.22836189978839622,0.72308190500483405,1.2659711905263935,0.10398123549903991,0.55003646368047454,0.12481785412635681,0.25485420870258896,-0.46717949444151136,0.35296966572384997,0.33361076682491503,0.54314555077976623,0.58383437747186417,0.084616852194787373,0.068925031656013491,0.32778730833391695,0.18273779362136691,-0.14905594436978531,-0.32850447383432396,-0.24444087601634412,-0.26749544731025543,0.16335030068761575,0.36826218975458774,0.70517213179946514,0.68028676352813322,0.31403243824923643,0.4209542873138814,0.48428741998121788,-0.19418231471315156,-0.40761959361100797,0.37203705990950142,0.26852439662201444,0.68192672486362638,0.6707115445117201,0.034464444368268239,0.40438584800732486,1.0122482275317142,0.50491009333710835,0.21265468378116933,0.29321892925141846,-0.017738190112416855,0.75609336659901405,0.34889780645033552],\"z\":[0.40656802546769399,0.018014186646239945,0.33832576498089589,0.17959139187535453,0.30775789623478433,-0.041076090823956656,-0.16981023986057561,-0.012302919237596209,0.41533608475939726,-0.28114143117641061,0.26981718276885164,-0.1305477502404867,0.69414683014441836,0.062114408322260527,-0.090457690725705059,0.31462097583217202,-0.32802752837859583,0.27116183725106618,0.49951904648511208,0.23500210497205515,-0.45962099135910461,0.22985388760895104,0.34785435225730749,0.23107177773628423,0.32180093724447351,0.31620907371157381,0.5217027796644188,0.16492098374357991,-0.035424504846160741,0.31849158062304639,0.24421381043355372,0.30642056121765765,0.1772427660112437,-0.016167127520729494,-0.44443349863980852,-0.38896306309821105,0.23716700988387537,0.61472084259182158,-0.18836681164619531,0.060009225855337356,0.024306855718950981,0.0099469328943483266,0.22941024143915595,0.1056911489030188,-0.016617170198266199,-0.083204290895677213,-0.077996351087676233,0.20539496698326026,0.012599647557889398,-0.010581660495571268],\"showlegend\":false,\"type\":\"scatter3d\",\"marker\":{\"color\":\"rgba(0,186,56,1)\",\"size\":7,\"line\":{\"color\":\"black\",\"opacity\":0.5,\"width\":1}},\"name\":\"versicolor\",\"textfont\":{\"color\":\"rgba(0,186,56,1)\"},\"error_y\":{\"color\":\"rgba(0,186,56,1)\"},\"error_x\":{\"color\":\"rgba(0,186,56,1)\"},\"line\":{\"color\":\"rgba(0,186,56,1)\"},\"frame\":null},{\"mode\":\"markers\",\"x\":[2.531192727803631,1.415235876703905,2.6166760159956928,1.9715310530434382,2.3500059200446426,3.3970387360532612,0.52123224390977607,2.9325870689936919,2.321228816573381,2.9167509667860756,1.661774153636534,1.8034019529650938,2.1655917960801476,1.3461635794584539,1.5859282238732235,1.9044563747934296,1.9496890593990719,3.4870553642902822,3.7956454220728872,1.3007917126376596,2.4278179130660482,1.1990011054655629,3.4999200389245408,1.3887661316914679,2.2754305038722076,2.6140904738108341,1.2585081605114903,1.2911320591150235,2.1236087227738976,2.3880030160034704,2.8416727781038733,3.2306736614320952,2.1594376424890527,1.444161242329512,1.7812948100451147,3.0764999316871906,2.1442433143020847,1.9050981488140784,1.1693263393415028,2.1076111432572446,2.3141547052356026,1.9222678009026037,1.415235876703905,2.5630133750774786,2.418746182732828,1.9441097945469707,1.52716661481452,1.7643457170444317,1.9009416142184261,1.3901888619479164],\"y\":[0.0098491094988011618,0.57491634754648901,-0.34390315134173521,0.17972790435224476,0.040260947142530285,-0.5508366730280565,1.1927587270006452,-0.35550000297749734,0.24383150231069003,-0.78279194881527958,-0.24222840775506779,0.21563761733355485,-0.2162755850740255,0.7768183473443393,0.53964071402671832,-0.11925069209197341,-0.041943259663212148,-1.1757393297134309,-0.25732297342048038,0.76114963643506317,-0.37819601261705155,0.60609152775793007,-0.4606740989118962,0.20439932735215041,-0.33499060582167828,-0.56090135512307882,0.17970479472274611,0.11666865117401083,0.20972947667730213,-0.46463980470873734,-0.37526916719510417,-1.3741650867930491,0.21727757866904848,0.1434134104575801,0.49990168107813593,-0.68808567757117667,-0.14006420108979073,-0.049300526013030962,0.16499026202310901,-0.37228787196079854,-0.18365127916901977,-0.40920346681606296,0.57491634754648901,-0.27786260292919557,-0.30479819785469286,-0.18753230280060593,0.37531698258048801,-0.078858854518476448,-0.11662795851202444,0.28266093799054998],\"z\":[-0.76016542724589609,-0.29632252738796533,0.11078788321910843,-0.10842466246342365,-0.28538956318444203,0.34843755579746699,-0.54565929564681381,0.4202399357679677,0.34830439493484422,-0.42333541768255883,-0.24244018972576958,0.037648168231481781,-0.033326641844325822,-0.28190288211846576,-0.62902932640801146,-0.47963981962659125,-0.044186167630122633,-0.13389487393609831,0.51376776381780398,0.3449950383134171,-0.21911932430194381,-0.51185550869700192,0.57318224256800232,0.064522756631267594,-0.28615009116915036,0.20553452435362451,-0.045847703927250641,-0.2312564626599711,-0.15418002392883084,0.44953019194184946,0.49889807587076818,0.11454820547541915,-0.20876316713083845,0.15323388806308944,0.17287518911341901,0.33559229243454058,-0.73487893672551163,-0.16218023577073762,-0.28183584020848107,-0.027291132141631261,-0.32269374717305971,-0.11358659579935715,-0.29632252738796533,-0.29256952459674335,-0.50448266397718056,-0.17782509063265811,0.1218981718671809,-0.13048163128784876,-0.72325156348991781,-0.36290964808537646],\"showlegend\":false,\"type\":\"scatter3d\",\"marker\":{\"color\":\"rgba(97,156,255,1)\",\"size\":7,\"line\":{\"color\":\"black\",\"opacity\":0.5,\"width\":1}},\"name\":\"virginica\",\"textfont\":{\"color\":\"rgba(97,156,255,1)\"},\"error_y\":{\"color\":\"rgba(97,156,255,1)\"},\"error_x\":{\"color\":\"rgba(97,156,255,1)\"},\"line\":{\"color\":\"rgba(97,156,255,1)\"},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_biplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot PCA biplot — plot_PCA_biplot","title":"Plot PCA biplot — plot_PCA_biplot","text":"PCA SVD \\(X = USV^T\\), uses standardized principal components data points (\\(\\bf{U}\\sqrt{n - 1}\\)) loadings (\\(\\bf{VS}/\\sqrt{n-1}\\)) plots onto scale - \"proper\" PCA biplot according Stack Exchange thread citing Gabriel 1971 paper PCA biplots.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_biplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot PCA biplot — plot_PCA_biplot","text":"","code":"plot_PCA_biplot(   obj,   PCx = \"PC1\",   PCy = \"PC2\",   anno = NULL,   annoname = \"Sample\",   annotype = \"Batch\",   label = c(\"Both\", \"Loadings\", \"Scores\", \"None\"),   colors = NULL,   col_load = \"firebrick\",   title = NULL,   ellipse = FALSE,   savename = NULL,   height = 8,   width = 8 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_biplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot PCA biplot — plot_PCA_biplot","text":"obj prcomp object PCx string; Component x-axis PCy string; Component y-axis anno df; Annotation info observations annoname string; Colname anno matching data points annotype string; Colname anno desired coloring label c(\"\", \"Loadings\", \"Scores\", \"None\"); points label colors char vector; Length number unique annotypes col_load string; Color loading arrow segments title string; Plot title ellipse logical; Draw ggplot2::stat_ellipse data ellipse w/ default params - confidence ellipse savename string; File path save plot height numeric; Saved plot height width numeric; Saved plot width","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_biplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot PCA biplot — plot_PCA_biplot","text":"Biplot ggplot object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_biplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot PCA biplot — plot_PCA_biplot","text":"","code":"data(iris) iris$Sample = rownames(iris) PCA_iris <- Rubrary::run_PCA(t(iris[,c(1:4)]),   center = TRUE, scale = FALSE, screeplot = FALSE) Rubrary::plot_PCA_biplot(   obj = PCA_iris,   anno = iris[,c(\"Sample\", \"Species\")],   annoname = \"Sample\", annotype = \"Species\",   label = \"Loadings\", ellipse = TRUE, title = \"Iris PCA Biplot\")"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot PCA matrix via GGally::ggpairs — plot_PCA_matrix","title":"Plot PCA matrix via GGally::ggpairs — plot_PCA_matrix","text":"\"scores\" PCA plots.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot PCA matrix via GGally::ggpairs — plot_PCA_matrix","text":"","code":"plot_PCA_matrix(   df_pca,   PCs = c(1:3),   anno = NULL,   annoname = \"Sample\",   annotype = \"Type\",   colors = NULL,   title = NULL,   savename = NULL,   width = 8,   height = 8 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot PCA matrix via GGally::ggpairs — plot_PCA_matrix","text":"df_pca string/prcomp obj; (path ) PCA output sample names first column PCs num vector; list numeric PCs plot (ex. c(1:3) first 3 PCs) anno string/df; Annotation info DF annoname string; Colname anno matching point name annotype string; Colname anno info color colors char vector; discrete annotype, length number unique annotypes. title string; Plot title savename string; File path save plot width numeric; Saved plot width height numeric; Saved plot height","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot PCA matrix via GGally::ggpairs — plot_PCA_matrix","text":"ggmatrix object PCA scatter plot matrix","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_PCA_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot PCA matrix via GGally::ggpairs — plot_PCA_matrix","text":"","code":"data(iris) iris$Sample = rownames(iris) plot_PCA_matrix(   df_pca = Rubrary::run_PCA(t(iris[,c(1:4)]), screeplot = FALSE),   PCs = c(1:3),   anno = iris[,c(\"Sample\", \"Species\")],   annoname = \"Sample\",   annotype = \"Species\",   title = \"Iris PCA\" )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_comp_barplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot stacked barplot filled by group — plot_comp_barplot","title":"Plot stacked barplot filled by group — plot_comp_barplot","text":"Plot stacked barplot filled group","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_comp_barplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot stacked barplot filled by group — plot_comp_barplot","text":"","code":"plot_comp_barplot(   sobj,   breaks,   group,   stack = TRUE,   counts = TRUE,   title = ggplot2::waiver(),   xlabel = breaks,   colors = NULL,   ncol_legend = NULL,   savename = NULL,   width = 7,   height = 7 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_comp_barplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot stacked barplot filled by group — plot_comp_barplot","text":"sobj Seurat object breaks string; metadata colname sobj set breaks / columns group string; metadata colname sobj split columns stack logical; split stacked plots counts + fraction counts logical; T include counts barplot stacked barplot title string; plot title xlabel string; x-axis (breaks) label colors char vector; list colors (n = # unique groups), \"alpha\" ncol_legend integer; # legend columns savename string; filepath save plot width numeric; saved plot width height numeric; saved plot height","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_comp_barplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot stacked barplot filled by group — plot_comp_barplot","text":"Stacked barplot, filled group composition","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Density plot by group — plot_density","title":"Density plot by group — plot_density","text":"Density plot group","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density plot by group — plot_density","text":"","code":"plot_density(   df,   value,   group,   group2 = NA,   title = NA,   pval = T,   xlab = value,   colors = c(\"firebrick3\", \"gray\"),   rug = F,   rug_label = F,   rug_lab_nudge = 1e-05,   savename = NA,   width = 6,   height = 4 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density plot by group — plot_density","text":"df dataframe value string; colname values group string; colname group info group2 string; group interest title string; plot title pval logical; get KSpval first group vs others xlab string; x-axis label colors vector; # colors = # groups rug logical; put rug plot x axis rug_label logical; label rug ticks first df column rug_lab_nudge numeric; fine-tune distance label x-axis savename string; filepath save PNG width numeric; ggsave width plot height numeric; ggsave height plot","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density plot by group — plot_density","text":"Density plot group","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_density.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Density plot by group — plot_density","text":"","code":"set.seed(13) df = data.frame(   group = c(rep(\"A\", 50), rep(\"B\",50)),   values = c(rnorm(50, mean = 0), rnorm(50, mean = 2))) plot_density(df, value = \"values\", group = \"group\")"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_dimplot_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Seurat DimPlot grid set — plot_dimplot_grid","title":"Plot Seurat DimPlot grid set — plot_dimplot_grid","text":"Plot Seurat DimPlot grid set","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_dimplot_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Seurat DimPlot grid set — plot_dimplot_grid","text":"","code":"plot_dimplot_grid(   sobj,   reduction = c(\"umap\", \"pca\", \"tsne\"),   set,   ncol = 3,   guides = NULL,   redtitle = FALSE,   gridtitle = NULL,   gridsubtitle = NULL,   cols_num = c(\"blue\", \"red\"),   savename = NULL,   width = NULL,   height = NULL )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_dimplot_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Seurat DimPlot grid set — plot_dimplot_grid","text":"sobj Seurat object reduction c(\"pca\", \"tsne\", \"umap); must already present sobj set dataframe vector; col1 metadata name, col2 (opt) subplot description, col3 (opt) logical T/F label ncol number columns grid guides string; specify guides treated layout (?patchwork::wrap_plots) redtitle logical; TRUE prepend reduction method subplot title gridtitle string; title overall dimplot grid gridsubtitle string; subtitle overall dimplot grid cols_num char vector; two colors low numeric legend range high numeric legend range savename string; filepath save figure width integer; plot width, unspecified try calculate height integer; plot height, unspecified try calculate","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_dimplot_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Seurat DimPlot grid set — plot_dimplot_grid","text":"Patchwork grid Seurat DimPlots","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_distribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot distribution of numeric vector — plot_distribution","title":"Plot distribution of numeric vector — plot_distribution","text":"Ignores NA values mean & median calculation.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_distribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot distribution of numeric vector — plot_distribution","text":"","code":"plot_distribution(   values,   check_normal = FALSE,   hist = FALSE,   title = \"Distribution\",   xlab = \"Value\",   savename = NULL,   height = 5,   width = 7 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_distribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot distribution of numeric vector — plot_distribution","text":"values numeric vector; values check distribution check_normal logical; perform SW test normality? hist logical; include histogram? title string; plot title xlab string; x-axis label savename string; filepath save figure height numeric; plot height width numeric; plot width","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_distribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot distribution of numeric vector — plot_distribution","text":"Plot distribution median + mean indicated","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_distribution.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot distribution of numeric vector — plot_distribution","text":"","code":"set.seed(13) vals_normal <- rnorm(100) plot_distribution(values = vals_normal, title = \"Normal\", hist = TRUE, check_normal = TRUE) #> Shapiro-Wilk normality test: p-value = 0.273 #> ** p = 0.273 > 0.05; normal #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.   vals_sequential <- c(1:100) plot_distribution(values = vals_sequential, title = \"Sequential\", check_normal = TRUE) #> Shapiro-Wilk normality test: p-value = 0.00172 #> ** p = 0.00172 <= 0.05; non-normal"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_featurescatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot FeatureScatter wrapper — plot_featurescatter","title":"Plot FeatureScatter wrapper — plot_featurescatter","text":"Wrapper Seurat::FeatureScatter extras like saving options, plot title, correlation plot subtitle","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_featurescatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot FeatureScatter wrapper — plot_featurescatter","text":"","code":"plot_featurescatter(   sobj,   feat1,   feat2,   group = \"sample_id\",   title = NULL,   savename = NULL,   corr_method = c(\"pearson\", \"kendall\", \"spearman\"),   height = 7,   width = 9 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_featurescatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot FeatureScatter wrapper — plot_featurescatter","text":"sobj Seurat object feat1 string; 1st feature plot (x-axis) feat2 string; 2nd feature plot (y-axis) group string; metadata colname group title string; plot title savename string; filepath save plot corr_method string; stats::cor method correlation calculation height numeric; plot height width numeric; plot width","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_featurescatter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot FeatureScatter wrapper — plot_featurescatter","text":"FeatureScatter ggplot output","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_scatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot simple scatter — plot_scatter","title":"Plot simple scatter — plot_scatter","text":"Correlation value method gets placed plot caption / bottom-right.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_scatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot simple scatter — plot_scatter","text":"","code":"plot_scatter(   df = NULL,   xval,   yval,   label = NULL,   group = NULL,   colors = NULL,   rank = FALSE,   xlabel = ifelse(methods::is(xval, \"character\"), xval, \"X\"),   ylabel = ifelse(methods::is(yval, \"character\"), yval, \"Y\"),   cormethod = c(\"pearson\", \"spearman\", \"none\"),   guides = TRUE,   pt_size = 2,   pt_alpha = 1,   lbl_size = 3,   density = FALSE,   reverse = FALSE,   title = NULL,   subtitle = NULL,   savename = NULL,   width = 8,   height = 8 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_scatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot simple scatter — plot_scatter","text":"df dataframe; includes signatures xval string/numeric vector; colname x axis yval string/numeric vector; colname y axis label string; colname point labels group string; colname group color colors char vector; list colors, length = # unique groups rank logical; change metric rank xlabel string; xval description ylabel string; yval description cormethod string; correlation method stats::cor() \"none\" guides logical; T include fitted linear model line pt_size numeric; point size pt_alpha numeric; point alpha value lbl_size numeric; label text size density logical; show density plot along axes reverse logical; T reverse axes title string; plot title subtitle string; plot subtitle savename string; filepath save figure width numeric; plot width height numeric; plot height","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_scatter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot simple scatter — plot_scatter","text":"Simple scatter plot ggplot2","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_scatter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot simple scatter — plot_scatter","text":"","code":"df <- data.frame(A = 1:10, B = 11:20, C = LETTERS[1:10], D = rep(LETTERS[1:5], each = 2)) plot_scatter(df, xval = \"A\", yval = \"B\", label = \"C\", group = \"D\", title = \"Example Scatter\")"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_screeplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot screeplot from prcomp — plot_screeplot","title":"Plot screeplot from prcomp — plot_screeplot","text":"Plot screeplot prcomp","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_screeplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot screeplot from prcomp — plot_screeplot","text":"","code":"plot_screeplot(   obj_prcomp,   npcs = ncol(obj_prcomp$x),   label = FALSE,   cum_var_exp = 80,   savename = NULL )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_screeplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot screeplot from prcomp — plot_screeplot","text":"obj_prcomp prcomp function output object npcs integer; # PCs include plot label logical; T % values points cum_var_exp integer; c(1:100), cumulative variance explained threshold savename string; filepath save PNG ","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_screeplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot screeplot from prcomp — plot_screeplot","text":"Screeplot ggplot object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_screeplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot screeplot from prcomp — plot_screeplot","text":"","code":"data(iris) PCA_iris <- Rubrary::run_PCA(t(iris[,c(1:4)]), screeplot = FALSE) Rubrary::plot_screeplot(PCA_iris) #> ** Cumulative var. exp. >= 80% at PC 1 (92.5%)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_volcano.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot (DE genes) volcano plot — plot_volcano","title":"Plot (DE genes) volcano plot — plot_volcano","text":"Wrapper EnhancedVolcano::EnhancedVolcano() additional caption saving","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_volcano.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot (DE genes) volcano plot — plot_volcano","text":"","code":"plot_volcano(   df,   names = \"gene\",   x = \"log2FoldChange\",   y = \"pvalue\",   pCutoff = 5e-04,   FCcutoff = 1,   xlab_high = NULL,   xlab_low = NULL,   xlab_size = 7,   title = NULL,   subtitle = NULL,   savename = NULL,   height = 12,   width = 16 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_volcano.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot (DE genes) volcano plot — plot_volcano","text":"df df/string; (path ) test statistics, w/ cols names, x, y names string; colname df w/ feature names (genes) x string; colname log2 fold changes y string; colname nominal/adj p-values pCutoff numeric; value set p value cutoff FCcutoff numeric; value set log fold change cutoff xlab_high string; description high x values (\\u2191 arrow!) xlab_low string; description low x values (\\u2193 arrow!) xlab_size numeric; size x labels title string; plot title subtitle string; plot subtitle savename string; full name file save height numeric; saved plot height width numeric; saved plot width","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_volcano.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot (DE genes) volcano plot — plot_volcano","text":"ggplot2 volcano plot","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_waterfall.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot horizontal waterfall plot (with optional density) — plot_waterfall","title":"Plot horizontal waterfall plot (with optional density) — plot_waterfall","text":"ggtext package installed, fancy version p_enrichment. :)","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_waterfall.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot horizontal waterfall plot (with optional density) — plot_waterfall","text":"","code":"plot_waterfall(   sig,   highlight,   rankcol,   rankcol_name = rankcol,   hightolow = FALSE,   vertical = FALSE,   label = TRUE,   replab_size = 3.5,   density = FALSE,   hllab = \"Highlight\",   otherlab = \"Other\",   pval = TRUE,   colors = c(\"firebrick3\", \"gray\"),   lab_high = NULL,   lab_low = NULL,   lab_size = 6,   legendpos = \"none\",   title = NULL,   savename = NULL,   width = 10,   height = 5 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_waterfall.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot horizontal waterfall plot (with optional density) — plot_waterfall","text":"sig dataframe; names/genes 1st column + rankcol columns highlight vector; list names highlight waterfall rankcol string; colname values rank rankcol_name string; descriptive name values rank hightolow logical; T x-axis decreasing value vertical logical; T columns horizontal label logical; T label highlighted values replab_size numeric; size gene label density logical; T density plot side panel hllab string; description highlighted values otherlab string; description non-highlighted values pval logical; T include KS enrichment pvalue colors vector; two colors, highlight vs. lab_high string; descriptor high rankcol values lab_low string; descriptor low rankcol values lab_size numeric; size value annotation label legendpos vector; value btwn 0-1 legend coordinates (ggplot legend.position) title string; plot title savename string; filepath save figure width numeric; width plot height numeric; height plot","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_waterfall.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot horizontal waterfall plot (with optional density) — plot_waterfall","text":"Waterfall plot ggplot2 object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/plot_waterfall.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot horizontal waterfall plot (with optional density) — plot_waterfall","text":"","code":"library(dplyr) airway_deseq = Rubrary::airway_deseq_res %>% relocate(hgnc_symbol) genes = Rubrary::GSEA_pathways$GOBP_REGULATION_OF_GLUCOSE_IMPORT[1:20]  Rubrary::plot_waterfall(   sig = airway_deseq,   highlight = genes,   rankcol = \"sign_log_p\",   rankcol_name = \"Sign log p value\",   lab_high = \"\\U2191 in treated\\n\\U2193 in untreated\",   lab_low = \"\\U2191 in untreated\\n\\U2193 in treated\",   title = \"Airway Treated vs. Untreated DESeq - Glucose Import Regulation Genes\",   density = TRUE )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/pltAB.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot gene co-expression scatter for genes A vs B — pltAB","title":"Plot gene co-expression scatter for genes A vs B — pltAB","text":"Helper function 'genecoexp_scatter_hyper'","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/pltAB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot gene co-expression scatter for genes A vs B — pltAB","text":"","code":"pltAB(geneB, geneA, hyp_df, sobj, group)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/pltAB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot gene co-expression scatter for genes A vs B — pltAB","text":"geneB string; gene B geneA string; gene hyp_df dataframe; hypergeometric p-value table sobj Seurat object group string; metadata value group ","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/pltAB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot gene co-expression scatter for genes A vs B — pltAB","text":"Scatter plot","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/predict_PCA.html","id":null,"dir":"Reference","previous_headings":"","what":"PCA prediction by projecting query/test samples onto PCA of reference/train samples — predict_PCA","title":"PCA prediction by projecting query/test samples onto PCA of reference/train samples — predict_PCA","text":"Plot titles automatically constructed based parameters. Adding savedir argument result intermediate plots final projected scores output.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/predict_PCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PCA prediction by projecting query/test samples onto PCA of reference/train samples — predict_PCA","text":"","code":"predict_PCA(   train,   test,   scale = FALSE,   varimax = FALSE,   train_name = \"Train\",   train_anno = NULL,   train_annoname = NULL,   train_annotype = NULL,   train_colors = NULL,   test_name = \"Test\",   test_anno = NULL,   test_annoname = NULL,   test_annotype = NULL,   test_colors = NULL,   ellipse = FALSE,   label = FALSE,   flip = FALSE,   savedir = NULL,   height = 8,   width = 8,   fmt = \"png\",   test_only_plt = FALSE,   rank = 3 )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/predict_PCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PCA prediction by projecting query/test samples onto PCA of reference/train samples — predict_PCA","text":"train string/df; filepath /df reference/train samples data, genes/features rownames, samples/observations colnames test string/df; filepath /df query/test samples data, genes/features rownames, samples/observations colnames scale logical; T scale variables unit variance varimax logical; T perform varimax rotation train + test train_name string; descriptor train samples train_anno df; annotation info train samples train_annoname string; colname train_anno matching point name train_annotype string; colname train_anno info color train_colors char vector; list colors, length = # unique train_annotype, set NULL gray test_name string; descriptor test samples test_anno df; annotation info test samples test_annoname string; colname test_anno matching point name test_annotype string; colname test_anno info color test_colors char vector; list colors, length = # unique test_annotype ellipse logical (vector); length 2, ellipse[1] train data ellipse, ellipse[2] test data ellipse label logical (vector); length 2, label[1] train data label, label[2] test data label flip IMPLEMENTED - logical (vector); length 2, flip[1] flip x-axis values, flip[2] flip y-axis values savedir string; directory (+ prefix) save output ; directory, end string \"/\" height numeric; plot height width numeric; plot width fmt string; plot output format (ex. \"png\", \"pdf\") test_only_plt logical; save scatter projected test samples rank integer; maximal # PCs used prcomp; compatibility w/ glab version","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/predict_PCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PCA prediction by projecting query/test samples onto PCA of reference/train samples — predict_PCA","text":"ggplot object","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/predict_PCA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PCA prediction by projecting query/test samples onto PCA of reference/train samples — predict_PCA","text":"","code":"library(dplyr) data(iris) iris$Sample <- rownames(iris) set.seed(13) samp <- sample(nrow(iris), nrow(iris)*0.75) # Train data is 75% of iris iris_train <- iris[samp,] %>%   mutate(Batch = \"Train\",          Species = paste0(Species, \"_Train\")) iris_test <- iris[-samp,] %>%   mutate(Batch = \"Test\",          Species = paste0(Species, \"_Test\")) Rubrary::predict_PCA(   train = t(iris_train[,1:4]),   test = t(iris_test[,1:4]),   train_name = \"Iris Train\", train_anno = iris_train[,c(\"Sample\", \"Species\")],   train_annoname = \"Sample\", train_annotype = \"Species\",   train_colors = c(\"pink\", \"red\", \"darkred\"),   test_name = \"Iris Test\", test_anno = iris_test[,c(\"Sample\", \"Species\")],   test_annoname = \"Sample\", test_annotype = \"Species\",   test_colors = c(\"lightskyblue\", \"blue\", \"navy\"),   ellipse = c(FALSE, TRUE), label = FALSE ) #> Common features: 4"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/quantile_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile normalization, upper quartile by default — quantile_norm","title":"Quantile normalization, upper quartile by default — quantile_norm","text":"RNA-seq normalization, upper quartile normalization = divide read count 75th quantile read counts sample.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/quantile_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile normalization, upper quartile by default — quantile_norm","text":"","code":"quantile_norm(vals, q = 75, target = 1000, min = 1, perl = FALSE)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/quantile_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile normalization, upper quartile by default — quantile_norm","text":"vals numeric df/vector q numeric; quartile normalize (ex. q = 75 75th quantile / upper quartile) target numeric; value scale min numeric; filter values min quantile normalization perl logical; TRUE match output quartile_norm.pl commonly used Graeber Lab RNA-seq analysis","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/quantile_norm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile normalization, upper quartile by default — quantile_norm","text":"Quantile normalized numeric vector dataframe","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/reload_pkg.html","id":null,"dir":"Reference","previous_headings":"","what":"Reload package by installation path — reload_pkg","title":"Reload package by installation path — reload_pkg","text":"Reload package installation path","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/reload_pkg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reload package by installation path — reload_pkg","text":"","code":"reload_pkg(pkg = \"Rubrary\")"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/reload_pkg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reload package by installation path — reload_pkg","text":"pkg string; name package","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/reload_pkg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reload package by installation path — reload_pkg","text":"Reloads pkg","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rotate_varimax.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply varimax rotation to PCA scores — rotate_varimax","title":"Apply varimax rotation to PCA scores — rotate_varimax","text":"StackExchange reference","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rotate_varimax.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply varimax rotation to PCA scores — rotate_varimax","text":"","code":"rotate_varimax(obj_prcomp, ncomp = 2, normalize = TRUE, savename = NULL)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rotate_varimax.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply varimax rotation to PCA scores — rotate_varimax","text":"obj_prcomp prcomp object ncomp integer; number components perform rotation normalize logical; T Kaiser normalization: rows scaled unit length rotation, scaled back afterwards savename string; filepath (ext.) save results ","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rotate_varimax.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply varimax rotation to PCA scores — rotate_varimax","text":"varimax object varimax rotation mtx rotation, varimax rotated loadings, standardized scores std_scores, scores scores","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rotate_varimax.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Apply varimax rotation to PCA scores — rotate_varimax","text":"","code":"data(iris) iris$Sample = rownames(iris) PCA_iris <- Rubrary::run_PCA(t(iris[,c(1:4)])) #> ** Cumulative var. exp. >= 80% at PC 1 (92.5%)  PCA_iris_varimax <- Rubrary::rotate_varimax(PCA_iris) head(PCA_iris_varimax$scores) #>   Scores        V1          V2 #> 1      1 -2.049927 -0.79834207 #> 2      2 -2.682972 -0.04875324 #> 3      3 -2.802785 -0.11781979 #> 4      4 -2.883760  0.16196544 #> 5      5 -2.081479 -0.81471667 #> 6      6 -1.168493 -1.39132459 head(PCA_iris_varimax$loadings) #>       Loadings          V1          V2 #> 1 Sepal.Length  0.80645291 -0.08037849 #> 2  Sepal.Width -0.05531986 -0.39562981 #> 3 Petal.Length  1.65078788  0.62067282 #> 4  Petal.Width  0.68996837  0.26097986 Rubrary::plot_PCA(   df_pca = PCA_iris_varimax$scores,   PCx = \"V1\", PCy = \"V2\",   type = \"Scores\",   anno = iris[,c(\"Sample\", \"Species\")],   annoname = \"Sample\", annotype = \"Species\",   title = \"Iris PCA Varimax\" )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rread.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper for data.table::fread implementing row.names functionality — rread","title":"Wrapper for data.table::fread implementing row.names functionality — rread","text":"Default file reading function Rubrary functions data often large tables read.delim optimized high dimensionality. file extension xlsx, attempt use openxlsx::read.xlsx instead. Setting row.names != 0 result output data.frame.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rread.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper for data.table::fread implementing row.names functionality — rread","text":"","code":"rread(input, row.names = 0, make.names = TRUE, to_df = TRUE)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rread.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper for data.table::fread implementing row.names functionality — rread","text":"input string; fread input row.names integer; column use row names, 0 none make.names logical; TRUE ensure column names unique valid (replicating utils::read.table) to_df logical; T convert output data.frame","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rread.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper for data.table::fread implementing row.names functionality — rread","text":"Table read input","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rread.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wrapper for data.table::fread implementing row.names functionality — rread","text":"","code":"glab_Beltran_2016 <- \"https://raw.githubusercontent.com/graeberlab-ucla/glab.library/master/vignettes/PCA_tutorial/Beltran_2016_rsem_genes_upper_norm_counts_coding_log2.txt\" df <- Rubrary::rread(glab_Beltran_2016, row.names = 1, to_df = FALSE) Rubrary::corner(df, 5) #>         WCMC90_2_C WCMC0_5_N WCMC210_1_N WCMC90_4_C WCMC172_1_C #> A1BG      8.317177  9.081553    5.564872   7.694012    6.912446 #> A1CF      3.940270  7.809804    6.402112   3.554920    7.142071 #> A2M      15.581526 10.451833   11.921014  13.018555   10.855632 #> A2ML1    14.174641  3.518384    3.900017  14.368108    2.955852 #> A3GALT2   3.031307  3.256588    2.496437   0.000000    1.427445"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_GSEA_squared.html","id":null,"dir":"Reference","previous_headings":"","what":"Run GSEA Squared on GSEA results — run_GSEA_squared","title":"Run GSEA Squared on GSEA results — run_GSEA_squared","text":"Run GSEA Squared GSEA results","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_GSEA_squared.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run GSEA Squared on GSEA results — run_GSEA_squared","text":"","code":"run_GSEA_squared(   df_GSEA,   categories,   cat_terms,   rep0 = 2.2e-16,   signlogp_base = 10,   get_terms = FALSE,   terms_filt_freq = c(5, 500),   plot_type = c(\"jitter\", \"density\"),   plot_pval = TRUE,   title = NULL,   cat_colors = NULL,   savename = NULL,   plot_fmt = \"png\",   height = 8,   width = 8,   seed = 13,   verbose = TRUE )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_GSEA_squared.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run GSEA Squared on GSEA results — run_GSEA_squared","text":"df_GSEA df/string; (path ) GSEA results pathway NES columns categories char vector; list category names cat_terms char vector; list category terms element keywords separated \"|\", ex. \"CELL_CYCLE|MITOTIC|DNA_REPLICATION\" rep0 numeric; value replace pval == 0 results , use rep0 = 2.2e-16 (rounded .Machine$double.eps) original function signlogp_base integer; log base calculating signed log_base p metric get_terms logical; TRUE run Rubrary::get_GSEAsq_terms output filtered table terms associated statistics terms_filt_freq num vector length 2; get_GSEAsq_terms arg, filt_freq[1] minimum frequency, filt_freq[2] maximum frequency plot_type c(\"jitter\", \"density\"); GSEA squared output plot type plot_pval logical; TRUE append p-value category name. ggtext package installed, can fancy markdown formatting title string; plot title cat_colors char vector; list colors corresponding category savename string; path save outputs (extension) plot_fmt string; file extension save plot height numeric; output plot height width numeric; output plot width seed integer; randomization seed verbose logical; TRUE output intermediate messages","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_GSEA_squared.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run GSEA Squared on GSEA results — run_GSEA_squared","text":"GSEAsq object ggplot object plot, df original GSEA input categories pathways, df categories KS statistics categories, df terms KS statistics terms applicable","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_GSEA_squared.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run GSEA Squared on GSEA results — run_GSEA_squared","text":"","code":"library(dplyr) # Load data airway_deseq_res <- Rubrary::airway_deseq_res deseq_stats <- setNames(   airway_deseq_res[,\"sign_log_p\"],   airway_deseq_res[,\"hgnc_symbol\"] ) pthwys <- Rubrary::GSEA_pathways # Run (f)GSEA gsea_results <- fgsea::fgsea(   pathways = pthwys,   stats = deseq_stats,   eps = 0.0,   minSize = 15,   maxSize  = 500) %>%   arrange(NES) #> Warning: There are ties in the preranked stats (6.92% of the list). #> The order of those tied genes will be arbitrary, which may produce unexpected results. # Run GSEA Squared GSEAsq_terms <- c(\"METABOLIC\",\"DNA\") # Run GSEA squared GSEAsq <- Rubrary::run_GSEA_squared(   df_GSEA = gsea_results,   get_terms = FALSE, verbose = FALSE,   categories = GSEAsq_terms,   cat_terms = GSEAsq_terms,   plot_pval = TRUE,   plot_type = \"jitter\" ) names(GSEAsq) # Various outputs as list #> [1] \"plot\"       \"pathways\"   \"categories\" GSEAsq$plot"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_PCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PCA (prcomp wrapper) — run_PCA","title":"Run PCA (prcomp wrapper) — run_PCA","text":"Adapted glab.library::PCA_from_file.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_PCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PCA (prcomp wrapper) — run_PCA","text":"","code":"run_PCA(   df,   savename = NULL,   summary = FALSE,   center = TRUE,   scale = FALSE,   tol = 0.05,   rank = NULL,   screeplot = TRUE )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_PCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PCA (prcomp wrapper) — run_PCA","text":"df (path ) numeric dataframe; samples columns, genes/features rows savename string; filepath (ext.) save PCA scores, loadings, sdev summary logical; output summary info center logical; indicate whether variables shifted zero centered scale logical; indicate whether variables scaled unit variance tol numeric; indicate magnitude components omitted rank integer; number specifying maximal rank, .e., maximal number principal components used screeplot logical; output + save screeplot?","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_PCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run PCA (prcomp wrapper) — run_PCA","text":"prcomp obj","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_PCA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run PCA (prcomp wrapper) — run_PCA","text":"general, Z-score standardization (center = T; scale = T) PCA advised. (transformed) gene expression data, genearlly, center scale. center = T: PCA maximizes sum--squared deviations origin first PC. Variance maximized data pre-centered. scale = T: one feature varies others, feature dominate resulting principal components. Scaling also result components order magnitude. Use either tol rank, .","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_PCA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PCA (prcomp wrapper) — run_PCA","text":"","code":"data(iris) Rubrary::run_PCA(t(iris[,c(1:4)])) #> ** Cumulative var. exp. >= 80% at PC 1 (92.5%)  #> Standard deviations (1, .., p=4): #> [1] 2.0562689 0.4926162 0.2796596 0.1543862 #>  #> Rotation (n x k) = (4 x 4): #>                      PC1         PC2         PC3        PC4 #> Sepal.Length  0.36138659 -0.65658877  0.58202985  0.3154872 #> Sepal.Width  -0.08452251 -0.73016143 -0.59791083 -0.3197231 #> Petal.Length  0.85667061  0.17337266 -0.07623608 -0.4798390 #> Petal.Width   0.35828920  0.07548102 -0.54583143  0.7536574"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_RRHO.html","id":null,"dir":"Reference","previous_headings":"","what":"Run RRHO analysis — run_RRHO","title":"Run RRHO analysis — run_RRHO","text":"Inference amount agreement two sorted lists using Rank-Rank Hypergeometric Overlap test. Outputs RRHO results, hypermatrix heatmap, rank rank scatter, metric scatter.","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_RRHO.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run RRHO analysis — run_RRHO","text":"","code":"run_RRHO(   sig1,   sig2,   sig1_name,   sig2_name,   sig1_low = NA,   sig1_high = NA,   sig2_low = NA,   sig2_high = NA,   key = \"gene\",   metric1 = \"sign_log_p\",   metric2 = metric1,   steps = NULL,   savename = NULL,   webtool = TRUE,   BY = FALSE,   hm_method = c(\"ggplot\", \"lattice\"),   palette = \"Spectral\",   waterfall = TRUE,   scatter = TRUE,   plot_fmt = \"png\" )"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_RRHO.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run RRHO analysis — run_RRHO","text":"sig1 string/dataframe; path df sig1, cols key metric1 sig2 string/dataframe; path df sig2, cols key metric2 sig1_name string; description sig1 sig2_name string; description sig2 sig1_low string; description low sig1 values sig1_high string; description high sig1 values sig2_low string; description low sig2 values sig2_high string; description high sig2 values key string; colname corresponding values btwn sigs metric1 string; colname sig1 metric rank metric2 string; colname sig2 metric rank steps integer; RRHO step size savename string; filepath save results (extension) webtool logical; T output text formatted Graeber RRHO webtool logical; T Benjamini-Yekutieli FDR corrected pvalues hm_method string; make heatmap ggplot geom_raster lattice levelplot palette string; RColorBrewer continuous palette name waterfall logical; TRUE include waterfall subplots (hm_method = \"ggplot\" ) scatter logical; TRUE output metric & rank scatterplot plot_fmt string; file extension save plot ","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_RRHO.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run RRHO analysis — run_RRHO","text":"RRHO results, list plots scatter == TRUE ggplot RRHO heatmap object","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/run_RRHO.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run RRHO analysis — run_RRHO","text":"Arrows unicode \\u2193 () \\u2191 () want cool low/high descriptions B)","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rwrite.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper for data.table::fwrite with tab separated values (TSV) default parameters — rwrite","title":"Wrapper for data.table::fwrite with tab separated values (TSV) default parameters — rwrite","text":"Wrapper data.table::fwrite tab separated values (TSV) default parameters","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rwrite.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper for data.table::fwrite with tab separated values (TSV) default parameters — rwrite","text":"","code":"rwrite(x, file, sep = \"\\t\", quote = FALSE, row.names = FALSE)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rwrite.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper for data.table::fwrite with tab separated values (TSV) default parameters — rwrite","text":"x dataframe; fwrite input file string; filepath save output , extension sep string; separator columns quote string; T wrap fields quotes row.names logical; T write rownames file","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/rwrite.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper for data.table::fwrite with tab separated values (TSV) default parameters — rwrite","text":"Dataframe written savename file","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/split_line.html","id":null,"dir":"Reference","previous_headings":"","what":"Split text into multiple lines — split_line","title":"Split text into multiple lines — split_line","text":"Split text multiple lines","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/split_line.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split text into multiple lines — split_line","text":"","code":"split_line(text, chars = 40, lines = NULL)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/split_line.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split text into multiple lines — split_line","text":"text string chars integer; rough # characters per line lines integer; desired # lines","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/split_line.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split text into multiple lines — split_line","text":"text split lines longer split_nchar","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/split_line.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Split text into multiple lines — split_line","text":"","code":"lipsum <- \"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.\" writeLines(split_line(lipsum, chars = 50)) #> Lorem ipsum dolor sit amet, consectetur adipiscing elit, #> sed do eiusmod tempor incididunt ut labore #> et dolore magna aliqua. Ut enim ad #> minim veniam, quis nostrud exercitation ullamco laboris #> nisi ut aliquip ex ea commodo consequat. writeLines(split_line(lipsum, lines = 3)) #> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor #> incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, #> quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. writeLines(split_line(\"Short line of text!\")) #> Short line of text! writeLines(split_line(\"Short line of text!\", lines = 2)) #> Short line #> of text!"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/use_pkg.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if package is installed, prompt if not — use_pkg","title":"Check if package is installed, prompt if not — use_pkg","text":"Based https://stackoverflow.com//44660688","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/use_pkg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if package is installed, prompt if not — use_pkg","text":"","code":"use_pkg(..., strict = FALSE)"},{"path":"https://liaoyjruby.github.io/Rubrary/reference/use_pkg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if package is installed, prompt if not — use_pkg","text":"... string; package(s) check installed strict logical; strict requirements package install?","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/use_pkg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if package is installed, prompt if not — use_pkg","text":"None","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/reference/use_pkg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check if package is installed, prompt if not — use_pkg","text":"","code":"use_pkg(\"ggplot2\", \"dplyr\")"},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-0130","dir":"Changelog","previous_headings":"","what":"Rubrary 0.13.0","title":"Rubrary 0.13.0","text":"Major plot_PCA_3D: uses plotly library plot three dimensional scatter plots plot_PCA_matrix: can accommodate numeric / continuous annotations Minor PCA_Quickstart: PCA matrix & 3d plotting examples Beltran & penguin data sets","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-0120","dir":"Changelog","previous_headings":"","what":"Rubrary 0.12.0","title":"Rubrary 0.12.0","text":"Major plot_PCA_matrix Minor get_log_coding_geneexp uses filter_genes now remove reshape2 dependency remove survival related suggests bug fixes","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-0110","dir":"Changelog","previous_headings":"","what":"Rubrary 0.11.0","title":"Rubrary 0.11.0","text":"removed LOT old functions weren’t generalized well probably used anyways added examples various functions (DE genes / GSEA) reorganization function reference/index","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-0103","dir":"Changelog","previous_headings":"","what":"Rubrary 0.10.3","title":"Rubrary 0.10.3","text":"theme adjustments","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-0102","dir":"Changelog","previous_headings":"","what":"Rubrary 0.10.2","title":"Rubrary 0.10.2","text":"Removed old DESeq functions, reorganized, fixed various bugs","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-0101","dir":"Changelog","previous_headings":"","what":"Rubrary 0.10.1","title":"Rubrary 0.10.1","text":"GSEAsquared functions bug fixes","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-0100","dir":"Changelog","previous_headings":"","what":"Rubrary 0.10.0","title":"Rubrary 0.10.0","text":"run_GSEA_squared: main function, replicating glab.library::gsea_squared keyword_plot_method == 1 setting get_GSEAsq_terms: terms/keywords plot_GSEAsq_density moved set functions get_kspval signed enrichment score implementation visualization based franapoli/signed-ks-test Various bug fixes","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"new-0-9-6","dir":"Changelog","previous_headings":"","what":"New","title":"Rubrary 0.9.6","text":"rwrite & rread: fast data.table based read-write-functions","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"improved-0-9-6","dir":"Changelog","previous_headings":"","what":"Improved","title":"Rubrary 0.9.6","text":"get_log_coding_geneexp improvements - can specify log base now","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"new-0-9-5","dir":"Changelog","previous_headings":"","what":"New","title":"Rubrary 0.9.5","text":"finally !! able remove gridExtra dependency","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"improved-0-9-4","dir":"Changelog","previous_headings":"","what":"Improved","title":"Rubrary 0.9.4","text":"rename project_PCA descriptive predict_PCA","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"new-0-9-3","dir":"Changelog","previous_headings":"","what":"New","title":"Rubrary 0.9.3","text":"rread: wrapper data.table::fread() can pull rownames project_PCA: long awaited massive PCA projection script incorporating varimax","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"improved-0-9-3","dir":"Changelog","previous_headings":"","what":"Improved","title":"Rubrary 0.9.3","text":"Switch Seurat::DiscretePalette pals’s alphabet color palette","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"improved-0-9-2","dir":"Changelog","previous_headings":"","what":"Improved","title":"Rubrary 0.9.2","text":"plot_GSEA_barplot: sig_cutoff format p value significance parameter","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"improved-0-9-1","dir":"Changelog","previous_headings":"","what":"Improved","title":"Rubrary 0.9.1","text":"GSEA functions: improved name formatting enrichment plot plot_PCA: fixed subtitle non-annotated plots (thanks Duncan :) ) plot_GSEA_barplot: formatting flexibility improvements","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"general-0-9-0","dir":"Changelog","previous_headings":"","what":"General","title":"Rubrary 0.9.0","text":"PCA improvements + associated vignettes scRNA integration assessment metrics GSEA barplot, GSEAsq density plot comparison, associated helper functions","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"new-0-9-0","dir":"Changelog","previous_headings":"","what":"New","title":"Rubrary 0.9.0","text":"plot_GSEAsq_density: plot categorical percentile rank comparison two GSEA squared signatures plot_PCA_biplot: conventional biplot loadings standardized scores format_GSEA_name: cleans MSigDB underscore + caps names bit split_line: splits long text multiple lines based number char lines rotate_varimax: Varimax rotation prcomp output run_LISI: wrapper assess_integration specific LISI run_MixingMetric: wrapper assess_integration specific MixingMetric run_CellMixS: wrapper assess_integration specific cms","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"improved-0-9-0","dir":"Changelog","previous_headings":"","what":"Improved","title":"Rubrary 0.9.0","text":"run_PCA: fix eigenvector / loadings distinction plot_volcano: rewritten terms + args general align better w/ EnhancedVolcano documentation plot_PC_genes -> plot_genes, still defaults filtering PC genes technically gene list can passed filter dataframe plot_waterfall: little smarter place high/low value labels still quite dumb plot_scatter: color group, text options","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"vignettes-0-9-0","dir":"Changelog","previous_headings":"","what":"Vignettes","title":"Rubrary 0.9.0","text":"PCA_Walkthrough: based Lindsey Smith’s PCA tutorial, step step toy dataset PCA including math behind PCA_Quickstart: basic Palmer Penguin demonstration plotting scripts + replication Graeber Beltran PCA DE_Genes & GSEA: previous combined tutorial nows plit two","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"general-0-8-0","dir":"Changelog","previous_headings":"","what":"General","title":"Rubrary 0.8.0","text":"Gene accessing, LISI PCA functions improvements Functional vignettes","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"new-0-8-0","dir":"Changelog","previous_headings":"","what":"New","title":"Rubrary 0.8.0","text":"get_PC_genes: accesses BioMart database genes annotated protein coding filter_PC_genes: filter dataframe specified list genes, possible Seurat::UpdateSymbolList powered gene symbol correcting. Technically isn’t specific protein-coding filtering words list input. Technically specific getting description fields given list BioMart attrs probably add error/warning gene names don’t match, possible Seurat correction? convert_genes: access BioMart database convert gene name format outputs visualization help interpret resulting values","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"improved-0-8-0","dir":"Changelog","previous_headings":"","what":"Improved","title":"Rubrary 0.8.0","text":"run_PCA: additional documentation recommending standardization plot_PCA: accommodation passing prcomp object, custom colors","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"vignettes-0-8-0","dir":"Changelog","previous_headings":"","what":"Vignettes","title":"Rubrary 0.8.0","text":"PCA: changed palmerpenguins dataset actually run output DESeq_GSEA: working DESeq example airway dataset","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-070","dir":"Changelog","previous_headings":"","what":"Rubrary 0.7.0","title":"Rubrary 0.7.0","text":"230329 function improvements","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-060","dir":"Changelog","previous_headings":"","what":"Rubrary 0.6.0","title":"Rubrary 0.6.0","text":"230323: new GSEA Seurat DimPlot functions & improvements plot_GSEA_pathway plot_dim_set hypergeo_coexp","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-050","dir":"Changelog","previous_headings":"","what":"Rubrary 0.5.0","title":"Rubrary 0.5.0","text":"230303: New scRNA hypergeometric p-value plot function genecoexp_scatter_hyper phyper_df pltAB run_RRHO (WIP)","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-040","dir":"Changelog","previous_headings":"","what":"Rubrary 0.4.0","title":"Rubrary 0.4.0","text":"230203: new functions plot_waterfall plot_density check_normal calc_sumZscore various fixes","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-030","dir":"Changelog","previous_headings":"","what":"Rubrary 0.3.0","title":"Rubrary 0.3.0","text":"New DESeq functions + extras output_DESeq filter_DESeq_PC plot_DESeq_volcano plot_scatter_compare plot_screeplot plot_scatter_mtx (WIP)","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-020","dir":"Changelog","previous_headings":"","what":"Rubrary 0.2.0","title":"Rubrary 0.2.0","text":"plot_distribution: Density plot histo","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-015","dir":"Changelog","previous_headings":"","what":"Rubrary 0.1.5","title":"Rubrary 0.1.5","text":"Save option “plot_scatter”","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-014","dir":"Changelog","previous_headings":"","what":"Rubrary 0.1.4","title":"Rubrary 0.1.4","text":"Optional KS pval plot_waterfall_hl","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-013","dir":"Changelog","previous_headings":"","what":"Rubrary 0.1.3","title":"Rubrary 0.1.3","text":"plot_waterfall_hl label outside","code":""},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-012","dir":"Changelog","previous_headings":"","what":"Rubrary 0.1.2","title":"Rubrary 0.1.2","text":"Fixed export plot_waterfall_hl.R namespace","code":""},{"path":[]},{"path":"https://liaoyjruby.github.io/Rubrary/news/index.html","id":"rubrary-010","dir":"Changelog","previous_headings":"","what":"Rubrary 0.1.0","title":"Rubrary 0.1.0","text":"Added NEWS.md file track changes package.","code":""}]
