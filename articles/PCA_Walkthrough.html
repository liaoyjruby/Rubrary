<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Rubrary">
<title>Principal Component Analysis (PCA) Walkthrough • Rubrary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Principal Component Analysis (PCA) Walkthrough">
<meta property="og:description" content="Rubrary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Rubrary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/DE_Genes.html">Differential Gene Expression</a>
    <a class="dropdown-item" href="../articles/GSEA.html">Gene Set Enrichment Analysis (GSEA)</a>
    <a class="dropdown-item" href="../articles/PCA_Quickstart.html">Principal Component Analysis (PCA) Quickstart</a>
    <a class="dropdown-item" href="../articles/PCA_Walkthrough.html">Principal Component Analysis (PCA) Walkthrough</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/liaoyjruby/Rubrary/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Principal Component Analysis (PCA) Walkthrough</h1>
                        <h4 data-toc-skip class="author">Yi Jou (Ruby)
Liao</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/liaoyjruby/Rubrary/blob/HEAD/vignettes/PCA_Walkthrough.Rmd" class="external-link"><code>vignettes/PCA_Walkthrough.Rmd</code></a></small>
      <div class="d-none name"><code>PCA_Walkthrough.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://liaoyjruby.github.io/Rubrary/">Rubrary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Heavily adapted from <a href="https://ourarchive.otago.ac.nz/bitstream/handle/10523/7534/OUCS-2002-12.pdf?sequence=1&amp;isAllowed=y" class="external-link">Lindsay
Smith’s PCA tutorial</a>!<span class="citation">[1]</span> HIGHLY
recommend reading through to help develop intuitive understanding of
PCA, starting from very basic math prerequisites.</p>
<div class="section level3">
<h3 id="why">Why?<a class="anchor" aria-label="anchor" href="#why"></a>
</h3>
<ul>
<li>Identify patterns in high dimensional data</li>
<li>Express data in way to highlight similarities + differences</li>
<li>Patterns in data “compressed” to lower dimensions without much loss
of information</li>
</ul>
<p>Synonymous terms</p>
<ul>
<li>Dimension: feature, gene</li>
<li>Sample: observation</li>
<li>Adjusted: mean-adjusted, centered</li>
<li>Scale: variance</li>
</ul>
</div>
<div class="section level3">
<h3 id="statistics">Statistics<a class="anchor" aria-label="anchor" href="#statistics"></a>
</h3>
<div class="section level4">
<h4 id="variance">Variance<a class="anchor" aria-label="anchor" href="#variance"></a>
</h4>
<ul>
<li>Measure of spread in 1-dimensional data</li>
</ul>
<p><span class="math display">\[var(X) = \frac{\Sigma_{i=1}^n (X_i -
\bar{X})(X_i - \bar{X})}{n-1}\]</span></p>
<ul>
<li>
<span class="math inline">\(X_i\)</span>: individual value</li>
<li>
<span class="math inline">\(\bar{X}\)</span>: (sample) mean of all
values</li>
<li>
<span class="math inline">\(n\)</span>: sample size</li>
</ul>
</div>
<div class="section level4">
<h4 id="covariance">Covariance<a class="anchor" aria-label="anchor" href="#covariance"></a>
</h4>
<ul>
<li>Found between 2 dimensions</li>
<li>Measure of how much the dimensions vary from the mean <em>with
respect to each other</em>
</li>
<li>
<span class="math inline">\(cov\)</span> btwn one dimension and self
is the variance</li>
<li>
<span class="math inline">\(cov(X, Y) = cov(Y, X)\)</span> because
multiplication is commutative</li>
</ul>
<p><span class="math display">\[cov(X) = \frac{\Sigma_{i=1}^n (X_i -
\bar{X})(Y_i - \bar{Y})}{n-1}\]</span> Interpretation</p>
<ul>
<li>Sign: positive or negative
<ul>
<li>Positive: both dimensions increase together</li>
<li>Negative: as one dimension increases, the other decreases</li>
</ul>
</li>
<li>Zero: two dimensions are independent of each other</li>
</ul>
</div>
<div class="section level4">
<h4 id="covariance-matrix">Covariance matrix<a class="anchor" aria-label="anchor" href="#covariance-matrix"></a>
</h4>
<ul>
<li>
<span class="math inline">\(n\)</span>-dimensional set: <span class="math inline">\(\frac{n!}{(n-2)! \cdot 2}\)</span> total pairwise
covariance values</li>
<li>Represent all covariances as covariance matrix</li>
</ul>
<p><span class="math display">\[C^{n \times n} = (c_{i, j}, c_{i, j} =
cov(Dim_i, Dim_j))\]</span></p>
<ul>
<li>
<span class="math inline">\(C^{n \times n}\)</span>: matrix w/ <span class="math inline">\(n\)</span> rows &amp; <span class="math inline">\(n\)</span> columns (square)</li>
<li>
<span class="math inline">\(Dim_x\)</span>: <span class="math inline">\(x\)</span>th dimension</li>
<li>Entry in <span class="math inline">\((2, 3)\)</span> of covariance
matrix is <span class="math inline">\(cov(Dim_2, Dim_3)\)</span>
</li>
<li>Main diagonal: variance of dimension</li>
<li>Symmetrical about the main diagonal</li>
</ul>
<p>Ex. Covariance matrix for 3 dimensions/features <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, <span class="math inline">\(z\)</span></p>
<p><span class="math display">\[C = \pmatrix{
cov(x,x) = var(x) &amp; cov(x,y) &amp; cov(x,z) \\
cov(y,x) &amp; cov(y,y) = var(y) &amp; cov(y,z) \\
cov(z,x) &amp; cov(z,y) &amp; cov(z,z) = var(z)}\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="matrix-algebra">Matrix algebra<a class="anchor" aria-label="anchor" href="#matrix-algebra"></a>
</h3>
<div class="section level4">
<h4 id="eigenvectors">Eigenvectors<a class="anchor" aria-label="anchor" href="#eigenvectors"></a>
</h4>
<p>“Direction” part of PCA decomposition, the angle of the orthogonal
“rotation” which PCA amounts to.</p>
<ul>
<li>Can only be found for <em>square</em> matrices
<ul>
<li>Not all square matrices have eigenvectors</li>
<li>In <span class="math inline">\(n \times n\)</span> matrix w/
eigenvectors, there are <span class="math inline">\(n\)</span>
eigenvectors</li>
</ul>
</li>
<li>Even if scaled by some amt before multiplication, still get multiple
as a result
<ul>
<li>Length of vector doesn’t affect if it’s an eigenvector or not,
direction does</li>
<li>To keep eigenvector standard, usually scale all to length = 1 (unit
length)</li>
</ul>
</li>
<li>All eigenvectors of matrix are <em>perpendicular / orthogonal</em>
<ul>
<li>Can express data in terms of eigenvectors, instead of expressing in
terms of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axes</li>
<li>Core concept of PCA!</li>
</ul>
</li>
</ul>
<p>Non-eigenvector:</p>
<p><span class="math display">\[\pmatrix{2 &amp; 3 \\ 2 &amp; 1} \times
\pmatrix{1 \\ 3} = \pmatrix{11 \\ 5}\]</span></p>
<p>Eigenvector:</p>
<p><span class="math display">\[\pmatrix{2 &amp; 3 \\ 2 &amp; 1} \times
\pmatrix{3 \\ 2} = \pmatrix{12 \\ 8} = 4 \times \pmatrix{3 \\
2}\]</span></p>
<p>Scaled eigenvector is still an eigenvector:</p>
<p><span class="math display">\[2 \times \pmatrix{3 \\ 2} = \pmatrix{6
\\ 4}\]</span> <span class="math display">\[\pmatrix{2 &amp; 3 \\ 2
&amp; 1} \times \pmatrix{6 \\ 4} = \pmatrix{24 \\ 16} = 4 \times
\pmatrix{6 \\ 4}\]</span></p>
<p>Scaling eigenvector to unit length:</p>
<p>Eigenvector: <span class="math inline">\(\pmatrix{3 \\ 2}\)</span>
-&gt; Length = <span class="math inline">\(\sqrt{(3^2 + 2^2)} =
\sqrt{13}\)</span> -&gt; Scaled: <span class="math inline">\(\pmatrix{3
\\ 2} \div \sqrt{13} = \pmatrix{\frac{3}{\sqrt{13}} \\
\frac{2}{\sqrt{13}}}\)</span></p>
</div>
<div class="section level4">
<h4 id="eigenvalues">Eigenvalues<a class="anchor" aria-label="anchor" href="#eigenvalues"></a>
</h4>
<p>“Scale” part of PCA decomposition</p>
<ul>
<li>Amount by which original vector was scaled after multiplication by
the square matrix</li>
<li>In above eigendecomposition example, eigenvalue = 4</li>
<li>Usually if eigenvectors are found through machine solving,
eigenvalues are also returned</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="general-steps">General steps<a class="anchor" aria-label="anchor" href="#general-steps"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Get <span class="math inline">\(n\)</span>-dimensional data set</li>
<li>Standardize data</li>
<li>Calculate covariance matrix</li>
<li>Calculate eigenvectors + eigenvalues of covariance matrix</li>
<li>Choose components + form a feature vector</li>
<li>Derive new data set</li>
</ol>
</div>
<div class="section level2">
<h2 id="d-pca-walkthrough">2D PCA walkthrough<a class="anchor" aria-label="anchor" href="#d-pca-walkthrough"></a>
</h2>
<p>Replicating Lindsay Smith’s PCA tutorial <span class="citation">[1]</span>, step by step.</p>
<div class="section level3">
<h3 id="get-n-dimensional-data-set">Get <span class="math inline">\(n\)</span>-dimensional data set<a class="anchor" aria-label="anchor" href="#get-n-dimensional-data-set"></a>
</h3>
<ul>
<li>2-dimensional / 2 features</li>
<li>
<span class="math inline">\(x\)</span> dimension &amp; <span class="math inline">\(y\)</span> dimension</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">0.5</span>, <span class="fl">2.2</span>, <span class="fl">1.9</span>, <span class="fl">3.1</span>, <span class="fl">2.3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">1.1</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.4</span>, <span class="fl">0.7</span>, <span class="fl">2.9</span>, <span class="fl">2.2</span>, <span class="fl">3.0</span>, <span class="fl">2.7</span>, <span class="fl">1.6</span>, <span class="fl">1.1</span>, <span class="fl">1.6</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">Data</span></span>
<span><span class="co">#&gt;      x   y</span></span>
<span><span class="co">#&gt; 1  2.5 2.4</span></span>
<span><span class="co">#&gt; 2  0.5 0.7</span></span>
<span><span class="co">#&gt; 3  2.2 2.9</span></span>
<span><span class="co">#&gt; 4  1.9 2.2</span></span>
<span><span class="co">#&gt; 5  3.1 3.0</span></span>
<span><span class="co">#&gt; 6  2.3 2.7</span></span>
<span><span class="co">#&gt; 7  2.0 1.6</span></span>
<span><span class="co">#&gt; 8  1.0 1.1</span></span>
<span><span class="co">#&gt; 9  1.5 1.6</span></span>
<span><span class="co">#&gt; 10 1.1 0.9</span></span></code></pre></div>
<p>Visualize original, unadjusted data</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">Data</span>,</span>
<span>  xval <span class="op">=</span> <span class="st">"x"</span>, yval <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Figure 3.1: Original PCA Data"</span>,</span>
<span>  guides <span class="op">=</span> <span class="cn">F</span>, cormethod <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PCA_Walkthrough_files/figure-html/Fig3.1-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="standardize-adjust-data">Standardize / adjust data<a class="anchor" aria-label="anchor" href="#standardize-adjust-data"></a>
</h3>
<ul>
<li>Center data: subtract mean for each point per dimension
<ul>
<li>
<span class="math inline">\(x - \bar{x}\)</span>, <span class="math inline">\(y - \bar{y}\)</span>
</li>
</ul>
</li>
<li>Adjusted data set overall has mean of 0</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean adjust / center</span></span>
<span><span class="va">DataAdjust</span> <span class="op">&lt;-</span> <span class="va">Data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">.</span>, center <span class="op">=</span> <span class="cn">T</span>, scale <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">DataAdjust</span></span>
<span><span class="co">#&gt;        x     y</span></span>
<span><span class="co">#&gt; 1   0.69  0.49</span></span>
<span><span class="co">#&gt; 2  -1.31 -1.21</span></span>
<span><span class="co">#&gt; 3   0.39  0.99</span></span>
<span><span class="co">#&gt; 4   0.09  0.29</span></span>
<span><span class="co">#&gt; 5   1.29  1.09</span></span>
<span><span class="co">#&gt; 6   0.49  0.79</span></span>
<span><span class="co">#&gt; 7   0.19 -0.31</span></span>
<span><span class="co">#&gt; 8  -0.81 -0.81</span></span>
<span><span class="co">#&gt; 9  -0.31 -0.31</span></span>
<span><span class="co">#&gt; 10 -0.71 -1.01</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculate-covariance-matrix">Calculate covariance matrix<a class="anchor" aria-label="anchor" href="#calculate-covariance-matrix"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Covariance matrix</span></span>
<span><span class="va">cov_mtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">DataAdjust</span><span class="op">)</span></span>
<span><span class="va">cov_mtx</span></span>
<span><span class="co">#&gt;           x         y</span></span>
<span><span class="co">#&gt; x 0.6165556 0.6154444</span></span>
<span><span class="co">#&gt; y 0.6154444 0.7165556</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="eigendecomposition-of-covariance-matrix">Eigendecomposition of covariance matrix<a class="anchor" aria-label="anchor" href="#eigendecomposition-of-covariance-matrix"></a>
</h3>
<ul>
<li>Covariance matrix is square -&gt; can find eigenvectors +
eigenvalues</li>
<li>Eigenvectors are <em>unit</em> eigenvectors</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Eigenvalues</span></span>
<span><span class="va">eigenvalues</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">cov_mtx</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="va">eigenvalues</span></span>
<span><span class="co">#&gt;           [,1]</span></span>
<span><span class="co">#&gt; [1,] 1.2840277</span></span>
<span><span class="co">#&gt; [2,] 0.0490834</span></span>
<span><span class="co"># Eigenvectors</span></span>
<span><span class="va">eigenvectors</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">cov_mtx</span><span class="op">)</span><span class="op">$</span><span class="va">vectors</span><span class="op">)</span></span>
<span><span class="va">eigenvectors</span></span>
<span><span class="co">#&gt;           [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.6778734 -0.7351787</span></span>
<span><span class="co">#&gt; [2,] 0.7351787  0.6778734</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="choosing-components">Choosing components<a class="anchor" aria-label="anchor" href="#choosing-components"></a>
</h3>
<ul>
<li>2 dimensional data &gt; <span class="math inline">\(2 \times
2\)</span> covariance matrix -&gt; 2 eigenvectors</li>
<li>Ordering eigenvectors by highest to lowest eigenvalues is same as
ordering by significance</li>
<li>For larger dimensional data, can exclude uninformative / lower
eigenvalue eigenvectors</li>
<li>Feature vector is formed by matrix of vectors constructed by
eigenvectors kept
<ul>
<li><span class="math inline">\(FeatureVector = \pmatrix{eig_1 &amp;
eig_2 &amp; eig_3 &amp; ... &amp; eig_n}\)</span></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FeatureVector</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">eigenvectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">eigenvectors</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">FeatureVector</span></span>
<span><span class="co">#&gt;           [,1]       [,2]</span></span>
<span><span class="co">#&gt; [1,] 0.6778734 -0.7351787</span></span>
<span><span class="co">#&gt; [2,] 0.7351787  0.6778734</span></span></code></pre></div>
<p>Visualizing eigenvectors / PCs on adjusted data</p>
<ul>
<li>Eigenvectors are perpendicular, lines that characterize data</li>
<li>Eigenvector with largest eigenvalue is PC1 (blue dashed line)
<ul>
<li>Aligns with maximum variance in data, most significant relationship
btwn data dimensions</li>
</ul>
</li>
<li>2nd largest eigenvalue is PC2 (red dashed line)</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">DataAdjust</span>, <span class="co"># Mean adjusted data</span></span>
<span>  xval <span class="op">=</span> <span class="st">"x"</span>, yval <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Figure 3.2: Centered data w/ eigenvectors"</span>,</span>
<span>  guides <span class="op">=</span> <span class="cn">F</span>, cormethod <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>              slope <span class="op">=</span> <span class="va">eigenvectors</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">eigenvectors</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="co"># EV 1 / PC1</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>              slope <span class="op">=</span> <span class="va">eigenvectors</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="va">eigenvectors</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="co"># EV 2 / PC2</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PCA_Walkthrough_files/figure-html/Fig3.2_eigenplot-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="deriving-new-data-set">Deriving new data set<a class="anchor" aria-label="anchor" href="#deriving-new-data-set"></a>
</h3>
<p>The final data (“scores”) can be found by using the FeatureVector /
selected eigenvectors to rotate the centered data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FinalData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">FeatureVector</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">DataAdjust</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>PC1 <span class="op">=</span> <span class="va">V1</span>, PC2 <span class="op">=</span> <span class="va">V2</span><span class="op">)</span></span>
<span><span class="va">FinalData</span></span>
<span><span class="co">#&gt;            PC1         PC2</span></span>
<span><span class="co">#&gt; 1   0.82797019 -0.17511531</span></span>
<span><span class="co">#&gt; 2  -1.77758033  0.14285723</span></span>
<span><span class="co">#&gt; 3   0.99219749  0.38437499</span></span>
<span><span class="co">#&gt; 4   0.27421042  0.13041721</span></span>
<span><span class="co">#&gt; 5   1.67580142 -0.20949846</span></span>
<span><span class="co">#&gt; 6   0.91294910  0.17528244</span></span>
<span><span class="co">#&gt; 7  -0.09910944 -0.34982470</span></span>
<span><span class="co">#&gt; 8  -1.14457216  0.04641726</span></span>
<span><span class="co">#&gt; 9  -0.43804614  0.01776463</span></span>
<span><span class="co">#&gt; 10 -1.22382056 -0.16267529</span></span></code></pre></div>
<p>Visualizing the final data</p>
<ul>
<li>PC1, now the x-axis, is along the direction of highest variance in
data</li>
<li>PC2, now the y-axis, is orthogonal / perpendicular to PC1 and is
along the direction of 2nd highest variance in the data</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCA_scores_manual</span> <span class="op">&lt;-</span> <span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">FinalData</span>, <span class="co"># Mean adjusted data</span></span>
<span>  xval <span class="op">=</span> <span class="st">"PC1"</span>, yval <span class="op">=</span> <span class="st">"PC2"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Figure 3.3: Data transformed with 2 eigenvectors"</span>,</span>
<span>  guides <span class="op">=</span> <span class="cn">F</span>, cormethod <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PCA_scores_manual</span></span></code></pre></div>
<p><img src="PCA_Walkthrough_files/figure-html/Fig3.3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="transforming-back-to-original-data">Transforming back to original data<a class="anchor" aria-label="anchor" href="#transforming-back-to-original-data"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RowFinalData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">FinalData</span><span class="op">)</span></span>
<span><span class="va">RowDataAdjust_1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">FeatureVector</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">RowFinalData</span></span>
<span><span class="va">RowDataAdjust_1</span></span>
<span><span class="co">#&gt;      [,1]  [,2] [,3] [,4] [,5] [,6]  [,7]  [,8]  [,9] [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.69 -1.31 0.39 0.09 1.29 0.49  0.19 -0.81 -0.31 -0.71</span></span>
<span><span class="co">#&gt; [2,] 0.49 -1.21 0.99 0.29 1.09 0.79 -0.31 -0.81 -0.31 -1.01</span></span>
<span><span class="va">RowDataAdjust_2</span> <span class="op">=</span> <span class="va">FeatureVector</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">RowFinalData</span></span>
<span><span class="va">RowDataAdjust_2</span></span>
<span><span class="co">#&gt;      [,1]  [,2] [,3] [,4] [,5] [,6]  [,7]  [,8]  [,9] [,10]</span></span>
<span><span class="co">#&gt; [1,] 0.69 -1.31 0.39 0.09 1.29 0.49  0.19 -0.81 -0.31 -0.71</span></span>
<span><span class="co">#&gt; [2,] 0.49 -1.21 0.99 0.29 1.09 0.79 -0.31 -0.81 -0.31 -1.01</span></span>
<span><span class="co"># "Uncenter" by adding back original means</span></span>
<span><span class="va">OriginalMean</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">OriginalData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">RowDataAdjust_2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">V1</span>, y <span class="op">=</span> <span class="va">V2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="va">OriginalMean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>         y <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="va">OriginalMean</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">OriginalData</span></span>
<span><span class="co">#&gt;      x   y</span></span>
<span><span class="co">#&gt; 1  2.5 2.4</span></span>
<span><span class="co">#&gt; 2  0.5 0.7</span></span>
<span><span class="co">#&gt; 3  2.2 2.9</span></span>
<span><span class="co">#&gt; 4  1.9 2.2</span></span>
<span><span class="co">#&gt; 5  3.1 3.0</span></span>
<span><span class="co">#&gt; 6  2.3 2.7</span></span>
<span><span class="co">#&gt; 7  2.0 1.6</span></span>
<span><span class="co">#&gt; 8  1.0 1.1</span></span>
<span><span class="co">#&gt; 9  1.5 1.6</span></span>
<span><span class="co">#&gt; 10 1.1 0.9</span></span>
<span><span class="co"># Visualize recovered data</span></span>
<span><span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">OriginalData</span>,</span>
<span>  xval <span class="op">=</span> <span class="st">"x"</span>, yval <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Recovered Original PCA Data"</span>,</span>
<span>  guides <span class="op">=</span> <span class="cn">F</span>, cormethod <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PCA_Walkthrough_files/figure-html/orig_data-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="rubrary">Rubrary<a class="anchor" aria-label="anchor" href="#rubrary"></a>
</h3>
<p><code><a href="../reference/run_PCA.html">Rubrary::run_PCA</a></code> is a wrapper for
<code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">stats::prcomp</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCA</span> <span class="op">&lt;-</span> <span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/run_PCA.html">run_PCA</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Data</span><span class="op">)</span>, <span class="co"># 1 point per column</span></span>
<span>  center <span class="op">=</span> <span class="cn">T</span>, scale <span class="op">=</span> <span class="cn">F</span>, tol <span class="op">=</span> <span class="fl">0</span>, screeplot <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Visualize</span></span>
<span><span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_PCA.html">plot_PCA</a></span><span class="op">(</span></span>
<span>  <span class="va">PCA</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"PCA Scores"</span>,</span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PCA_Walkthrough_files/figure-html/Using%20Rubrary%20functions-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="pca-output">PCA output<a class="anchor" aria-label="anchor" href="#pca-output"></a>
</h2>
<div class="section level3">
<h3 id="scores">Scores<a class="anchor" aria-label="anchor" href="#scores"></a>
</h3>
<ul>
<li>Coordinates of individuals (observations) on principal
components</li>
<li>Original data orthogonally rotated by eigenvector directions</li>
<li>In <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">stats::prcomp</a></code>, this is the <code>x</code>
output</li>
</ul>
</div>
<div class="section level3">
<h3 id="loadings">Loadings<a class="anchor" aria-label="anchor" href="#loadings"></a>
</h3>
<ul>
<li>Eigenvectors “inoculated” w/ info about variability or magnitude of
the rotated data</li>
<li>Association coefficients between components + variables</li>
<li>Loadings: covariances/correlations btwn original variables +
unit-scaled components</li>
<li>Generally use loadings instead of eigenvectors when interpreting
components</li>
<li>In <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">stats::prcomp</a></code>, can use the <code>rotation</code>
output scaled/multiplied by the <code>sdev</code> output which is the
square roots of the eigenvalues of the covariance/correlation
matrix</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="va">obj_prcomp</span><span class="op">$</span><span class="va">rotation</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">obj_prcomp</span><span class="op">$</span><span class="va">sdev</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="links">Links<a class="anchor" aria-label="anchor" href="#links"></a>
</h4>
<ul>
<li><a href="https://stats.stackexchange.com/questions/143905/loadings-vs-eigenvectors-in-pca-when-to-use-one-or-another" class="external-link">Cross
Validated: Loadings vs eigenvectors in PCA: when to use one or
another?</a></li>
<li><a href="https://stats.stackexchange.com/questions/119746/what-is-the-proper-association-measure-of-a-variable-with-a-pca-component-on-a/119758#119758" class="external-link">Cross
Validated: What is the proper association measure of a variable with a
PCA component?</a></li>
<li><a href="https://stats.stackexchange.com/questions/92499/how-to-interpret-pca-loadings" class="external-link">Cross
Validated: How to interpret PCA loadings?</a></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="biplots">Biplots<a class="anchor" aria-label="anchor" href="#biplots"></a>
</h3>
<p>PCA: singular value decomposition <span class="math display">\[X =
USV^\intercal\]</span></p>
<p>Examples based on <code>iris</code> dataset from this <a href="https://stats.stackexchange.com/questions/141085/positioning-the-arrows-on-a-pca-biplot/141531#141531" class="external-link">thread</a>:
<img src="https://i.stack.imgur.com/6ddZg.png"></p>
<div class="section level4">
<h4 id="biplot-scores">Biplot scores<a class="anchor" aria-label="anchor" href="#biplot-scores"></a>
</h4>
<p>Two first principal components are plotted as a scatter plot,
i.e. first column of <span class="math inline">\(\bf{U}\)</span> is
plotted against its second column.</p>
<p>Possible normalizations:</p>
<ol style="list-style-type: decimal">
<li>Columns of <span class="math inline">\(\bf{U}\)</span>: principal
components scaled to unit sum of squares</li>
<li>Columns of <span class="math inline">\(\bf{U}\sqrt{n - 1}\)</span>:
standardized principal components (unit variance)</li>
<li>Columns of <span class="math inline">\(\bf{US}\)</span>: “raw”
principal components (projections on principal directions)
<ul>
<li>
<code>prcomp</code> object <code>x</code> output</li>
</ul>
</li>
</ol>
</div>
<div class="section level4">
<h4 id="biplot-loadings">Biplot loadings<a class="anchor" aria-label="anchor" href="#biplot-loadings"></a>
</h4>
<p>Original variables are plotted as arrows; i.e. <span class="math inline">\((x, y)\)</span> coordinates of an <span class="math inline">\(i\)</span>-th arrow endpoint are given by the
<span class="math inline">\(i\)</span>-th value in the first and second
column of <span class="math inline">\(\bf{V}\)</span>.</p>
<p>Possible normalizations:</p>
<ol style="list-style-type: decimal">
<li>Columns of <span class="math inline">\(\bf{VS}\)</span>: no valid
interpretation</li>
<li>Loadings: Columns of <span class="math inline">\(\bf{VS}/\sqrt{n-1}\)</span>
<ul>
<li>
<code>loadings &lt;- obj_prcomp$rotation %*% diag(obj_prcomp$sdev)</code>
<ul>
<li>Where <code>obj_prcomp$sdev</code> is square root of corresponding
eigenvalues</li>
</ul>
</li>
<li>Useful interpretation
<ul>
<li>Length of loading arrows <span class="math inline">\(\approx\)</span> std dev of original variables
<ul>
<li>Squared length <span class="math inline">\(\approx\)</span>
variance</li>
</ul>
</li>
<li>Scalar products between any two arrows <span class="math inline">\(\approx\)</span> covariance between them</li>
<li>Cosines of angles between arrows <span class="math inline">\(\approx\)</span> correlations between original
variables</li>
</ul>
</li>
</ul>
</li>
<li>Eigenvectors: Columns of <span class="math inline">\(\bf{V}\)</span>: these are principal axes (aka
principal directions)
<ul>
<li>
<code>prcomp</code> object <code>rotation</code> output</li>
</ul>
</li>
</ol>
</div>
<div class="section level4">
<h4 id="links-1">Links<a class="anchor" aria-label="anchor" href="#links-1"></a>
</h4>
<ul>
<li><a href="https://stats.stackexchange.com/a/141531/387770" class="external-link">Stack
Exchange: Positioning the arrows on a PCA biplot</a></li>
<li><a href="https://stats.stackexchange.com/questions/276645/arrows-of-underlying-variables-in-pca-biplot-in-r" class="external-link">Stack
Exchange: Arrows of underlying variables in PCA biplot in R</a></li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="standardization">Standardization<a class="anchor" aria-label="anchor" href="#standardization"></a>
</h2>
<ul>
<li>Center feature means at 0</li>
<li>Scale variance per feature to unit variance</li>
</ul>
<p>In general, should standardize data (Z-score normalize) before
PCA!</p>
<div class="section level3">
<h3 id="centering">Centering<a class="anchor" aria-label="anchor" href="#centering"></a>
</h3>
<ul>
<li>PCA is a regressional model <em>without</em> intercept
<ul>
<li>Principal components inevitably come through the origin</li>
</ul>
</li>
<li>Technically, PCA maximizes (by 1st PC) the sum-of-squared deviations
from the origin
<ul>
<li>PCA only maximizes variance if data is preliminarily centered</li>
</ul>
</li>
</ul>
<div class="section level4">
<h4 id="centering-example">Centering example<a class="anchor" aria-label="anchor" href="#centering-example"></a>
</h4>
<p>Using transformed version of previous 2D data set to emphasize
effect</p>
<ol style="list-style-type: decimal">
<li>Center / mean adjust</li>
<li>Reflect across y-axis (positive -&gt; negative correlation)</li>
<li>Uncenter</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Data2</span> <span class="op">&lt;-</span> <span class="va">Data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">.</span>, center <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="va">OriginalMean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>         y <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="va">OriginalMean</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Data2</span></span>
<span><span class="co">#&gt;            x         y</span></span>
<span><span class="co">#&gt; 1  0.9312548 2.4888568</span></span>
<span><span class="co">#&gt; 2  3.4783424 0.4805781</span></span>
<span><span class="co">#&gt; 3  1.3133179 3.0795270</span></span>
<span><span class="co">#&gt; 4  1.6953811 2.2525887</span></span>
<span><span class="co">#&gt; 5  0.1671285 3.1976611</span></span>
<span><span class="co">#&gt; 6  1.1859635 2.8432589</span></span>
<span><span class="co">#&gt; 7  1.5680267 1.5437845</span></span>
<span><span class="co">#&gt; 8  2.8415705 0.9531143</span></span>
<span><span class="co">#&gt; 9  2.2047986 1.5437845</span></span>
<span><span class="co">#&gt; 10 2.7142161 0.7168462</span></span></code></pre></div>
<p>Scatter plot shows result of transformation. Red guide line is fitted
linear regression line.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">Data2</span>,</span>
<span>  xval <span class="op">=</span> <span class="st">"x"</span>, yval <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Transformed PCA Data"</span>,</span>
<span>  guides <span class="op">=</span> <span class="cn">T</span>, cormethod <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PCA_Walkthrough_files/figure-html/2d_transformed%20visual-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="pca-without-centering">PCA without centering<a class="anchor" aria-label="anchor" href="#pca-without-centering"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCA2_NoCenter</span> <span class="op">&lt;-</span> <span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/run_PCA.html">run_PCA</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Data2</span><span class="op">)</span>, <span class="co"># 1 point per column</span></span>
<span>  center <span class="op">=</span> <span class="cn">F</span>, scale <span class="op">=</span> <span class="cn">F</span>, tol <span class="op">=</span> <span class="fl">0</span>, screeplot <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Extract eigenvectors</span></span>
<span><span class="va">evs_NoCenter</span> <span class="op">&lt;-</span> <span class="va">PCA2_NoCenter</span><span class="op">$</span><span class="va">rotation</span></span></code></pre></div>
<p>Plotting the first eigenvector (dashed line) with uncentered data
shows the 1st principal component piercing the cloud of points through
the origin, and not along the main direction of the cloud.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">Data2</span>, <span class="co"># Uncentered data</span></span>
<span>  xval <span class="op">=</span> <span class="st">"x"</span>, yval <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Uncentered data w/ PC1"</span>,</span>
<span>  guides <span class="op">=</span> <span class="cn">T</span>, cormethod <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>              slope <span class="op">=</span> <span class="va">evs_NoCenter</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">evs_NoCenter</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="co"># EV / PC 1</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PCA_Walkthrough_files/figure-html/no_centering_visual-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="pca-with-centering">PCA with centering<a class="anchor" aria-label="anchor" href="#pca-with-centering"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCA2_Center</span> <span class="op">&lt;-</span> <span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/run_PCA.html">run_PCA</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Data2</span><span class="op">)</span>, <span class="co"># 1 point per column</span></span>
<span>  center <span class="op">=</span> <span class="cn">T</span>, scale <span class="op">=</span> <span class="cn">F</span>, tol <span class="op">=</span> <span class="fl">0</span>, screeplot <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Extract eigenvectors</span></span>
<span><span class="va">evs_Center</span> <span class="op">&lt;-</span> <span class="va">PCA2_Center</span><span class="op">$</span><span class="va">rotation</span></span></code></pre></div>
<p>With centered data, the first eigenvector (PC1) crosses the origin
along the direction of the cloud of points.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Rubrary</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Data2</span>, center <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Centered data</span></span>
<span>  xval <span class="op">=</span> <span class="st">"x"</span>, yval <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Centered data w/ PC1"</span>,</span>
<span>  guides <span class="op">=</span> <span class="cn">F</span>, cormethod <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>              slope <span class="op">=</span> <span class="va">evs_Center</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">evs_Center</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="co"># EV / PC1</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PCA_Walkthrough_files/figure-html/centering_visual-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="links-2">Links<a class="anchor" aria-label="anchor" href="#links-2"></a>
</h4>
<ul>
<li><a href="https://stats.stackexchange.com/a/22331" class="external-link">Cross Validated:
How does centering the data get rid of the intercept in regression and
PCA?</a></li>
<li><a href="https://stats.stackexchange.com/a/189902" class="external-link">Cross Validated:
How does centering make a difference in PCA (for SVD and eigen
decomposition)?</a></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="scaling">Scaling<a class="anchor" aria-label="anchor" href="#scaling"></a>
</h3>
<p>Somewhat subjective depending on what you’re interested in
investigating.</p>
<p>Not scaling: performing PCA on covariance matrix</p>
<ul>
<li>Generally okay if variable scales are similar or variables have same
unit of measure</li>
</ul>
<p>Scaling: performing PCA on correlation matrix</p>
<ul>
<li>Generally preferred if variable scales are different or variables
have different unit of measure</li>
<li>PCA on correlation mtx is SAME as PCA with <em>standardization</em>
of each variable</li>
</ul>
<div class="section level4">
<h4 id="links-3">Links<a class="anchor" aria-label="anchor" href="#links-3"></a>
</h4>
<ul>
<li><a href="https://stats.stackexchange.com/a/78" class="external-link">Cross Validated: PCA
on correlation or covariance?</a></li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="varimax">Varimax<a class="anchor" aria-label="anchor" href="#varimax"></a>
</h2>
<p><a href="https://stats.stackexchange.com/a/193023/387770" class="external-link">From
@ttnphns on Stack Exchange</a>!! <img src="https://i.stack.imgur.com/AeZy1.png"></p>
<div class="section level3">
<h3 id="unstandardizing-scores">“Unstandardizing” scores<a class="anchor" aria-label="anchor" href="#unstandardizing-scores"></a>
</h3>
<div class="section level4">
<h4 id="links-4">Links<a class="anchor" aria-label="anchor" href="#links-4"></a>
</h4>
<ul>
<li><a href="https://stats.stackexchange.com/questions/59213/how-to-compute-varimax-rotated-principal-components-in-r" class="external-link">Cross
Validated: How to compute varimax-rotated principal components in
R?</a></li>
<li>
<a href="https://stats.stackexchange.com/questions/612/is-pca-followed-by-a-rotation-such-as-varimax-still-pca" class="external-link">Cross
Validated: Is PCA followed by a rotation (such as varimax) still
PCA?</a>
<ul>
<li>REALLY GOOD ANSWERS explaining math + consequences of rotation on
raw scores + eigenvectors vs. std scores + loadings</li>
<li><a href="https://stats.stackexchange.com/a/136936/387770" class="external-link"><span class="citation">[<strong>amoeba?</strong>]</span> answer</a></li>
<li><a href="https://stats.stackexchange.com/a/193023/387770" class="external-link"><span class="citation">[<strong>ttnphns?</strong>]</span> answer</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body">
<div id="ref-smithTutorialPrincipalComponents2002" class="csl-entry">
<div class="csl-left-margin">[1] </div>
<div class="csl-right-inline">Smith LI. <a href="https://ourarchive.otago.ac.nz/bitstream/handle/10523/7534/OUCS-2002-12.pdf?sequence=1&amp;isAllowed=y" class="external-link">A
tutorial on <span>Principal Components Analysis</span></a> 2002.</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Yi Jou (Ruby) Liao.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
